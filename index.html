<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"286154af7fb344c303c67c09e536b98c879a0e5def00fb0d28d4d56ebd1e80193581382e69c4a30aa9570ddd016951e023b797de59318580199a77ef01f6b3720f09a0a020e34adbb335c29f62c7d320e16f07643044cf5df81f79f79ce1c86fdcdf07668f3c4c34bfa1019f535dedacc31db7a3e6c8ad9d9400e7452446f75955d6e9efb8e83de4f2a62ff5ddb7657b9efba82c4fb177c23d2de585664e3bc61e25ec6067ef80f137feb84af38190a72dfca9f46910e09248dbc4045d55b2a2bd02ed016072cda828aa756c77979afda8268e985cf9f953423f5d18913097e627a757c31cafbea713c50f9b6d756c6cbbdea7b5b018a0b231c84cb28ec7fa925f420f2a01499a20f6514303796747ccfa3db51b16c21538d784f4685def035d53c18792f8f769da1ae499ac287f7840a761c6c95aef95bb082fafcd668e43f21ab8221d3ab05f84da1b85dc73cc85ab0f1f4a544b643c384a8794d74e1e18136abb9915481624b40472a36866418f8b6a41a457d123abada4c23ccd59a9f378d111569f34c3f16fa9f622e286f5d56a5e72b6216f7a8bba568d4b1e661b3d5e27c5e5ca7429423fc8ec9d2b24d40b35cca9779246af0ffbe7f92fcfeb62219b2411c55c5aa8307367b161ce6cfb93082e6b161efedceedd5b1b8d5f6bb8a7620d0ccf11cb0abc14c997ce63e0db0111afa7874eb6a9e1aa3ed18e459ce700844f0b30c7494d4fc1ea93694f6709fe8cbd7304d74b5875573c358cbb5d96fcd640515e1738d069f79501f4550495ab394f18f04f1227bcc16a3a6d7dacc9b8b7ccc82d40285e37fddbf14055361f7ab68f85ebe3ef0668818987f4d51f47bab0e84403a039085e0277785b575d8df4e83c718be5a9523ed63353714a495a27df533ddb89f4f76ce67be56922c981e59e8cf1d1c2c12e5d5504212ca5a8bce9f764031a25b879a73f4319745157e86902abb39c8c7bcea33108e9d7fdc1c75fae4a59b5d1830c15087df7ac445f8be7793e6c1752837f017c035a8c7af1fd4047c19da9fcde06dbb9e5542f104319a5914187eef146325b549837e84562f1a7aa0b7ab0099d7aaf46500da1508b04579f66f555d0ad49f2bf597f34c0b37686f5128d96e1d95cba9c5b06c855a2760eeffbcb926e7a78eba4111af45138154fb879e2aa83f3edb0058a43510fc11cefd676b0005eff8675737334e50e7aaaa104e6b9c77b8d66face5b907244c17863715545d3f2c717f99278a0d9df2325133f4a127c6063270ea7c38319bf4677dcfdc8f1e33dadc62d85ec14df4d10dad5c9fb2a46757d6c570c1df2a3f1e84cb7ea52d37eb58ce22461fb857c2645b6b6a6eec2e813a048a935a1b97947e29c248852c56d724c7e590e2dd3167e07e893cb92f277610754ea7d03434411a87f4286a6071c9282f93cb965781b5fe90064635155c310c2ad7be3ce6e642f7e754a4df015ca0df5f90abd298a8392e3a329caf42d635af363a440ac3ebc0aece4faa64c9cdbe50b9f4003fff3687dfe2b4905a53d529b715a65f3e84957077906cf2cf37541b427e599e424ff76e913753a8e22de6e1293aa65078fda708a499ccb516c6ffdb75a4fa53ecb0401225198559774731f6d842347c266f9a3cdef4df73428c1f3c33b29f1f2c6749309398310c773d7f1008b4fddb98bad0d9759e1119411fe5f02ad1e111e37adc60de111f5708ba70243f048b5aaef7ec7466504b54ce4b9b03b486d62374cf6a1c4b163e51bc80234b4bb523ac544aa9e52c698615b2d142b0fe8f25699be0e18c23344dc47840003574ffd79f23402f6563dc8ba4ea2680f0e385be72ad778935bca02222e7e231ae44e0c4698533f0e78b0b17ed3c7bb578b38c37b785b9fb3157244bb64edd51f68ec19cec52ea05301e21821a74cf5323ae889f6028202adc4c7b5d8651ee41cd4a82ff3298fc8c89c71167cca825c9d2829f65f960f797ae0bd0de6da9d99d4dbf82cc3885481fead67ba643bc5e370f68d2f548adb30eb5c33e4b61ad212b60bf3fdfe64d29fab228a8945d0525e24b3a0d0bb33b17276ff67e868e624e7d776b4c2a1dcfc7f1bd6f11ec1bc31ef4ec90703b4a78045a9157a26a1ee17a71ae14ab65325bd1a5fe7040a7500a98a7675e8aa8a72467f1628cd8186773d762fbdecb2feea1b6ac5f7944eb8a21f04dc0d3514192309ae0db22fdd5173f62ba53ccf9972b0958d7c307932b3c5e230d29bfb93afec6c271d4e7ce93432977ca95d689062a32ed54891ee2bbca331bf1204e58d4072ae71026d7163b22c7757d5b9ca1aa26851e16b1e9c58937e5bd80084ee640b5c227473e820b8b37d394a93050a80cdfcf57da0220ec8911191b48e6104e7e665e27c2c7b8b1f0b31ecfb76a6588e4f92fb0084bd495d59bd6d7a0870d332edf1e3935edb6624f1c02dfe7cf4ec11f748ffc992ef9bf3a57d4cae649c779039a028fd72452c68fb0fde6389bc09482bc6c5894b3340e60f97e3e63a2df81996c05777e7b3fab77a07dbb5f8f652397fff737c92f0bf43814f564385965fa54487eed09b9f2965e7fbf84c3f6af24882b327113d42407330d830ef0dbb2a87742966f644d2351afae3bfb150ad41ee2bc40d7391d6debd34a08979b84227fc637947b541a76b2b6fe5d0734d48a1be6d92838849a87be77e2348de5faf7ae8ede97e317dd0ffb4e137a106e50677b5a238ee72a150ceca2c588288bc133d093f36b740012afba3cc1d2d68bb1493d10419df555433dfd789357ec13b348b896879d09ff637e503970d27de13dbb79cf405ab8a71536ea01a7fc8d5a4ff3680b0168f5445aa00e222c9cfee48bbcec1a499358c6fe5505ffaf823c3d23b5f65a66265145f478731e6678f7af5e2cd332520e3c245276f4feb756b2c5572ce937a06d525270e00eaeba2cd23896df6ffe7d3f04c2d6ee7f6b53fd260892a963c2b7723393e1c812351a77f70b57dc2b56ee4b1f53b81d763d57059095df743efb0fd66ff52cccd758e5a2e34ac80dcbbffcbd90502171a98f1e982d4599eab34d7a87dee8c53f0797194066a74d5e44e89de7cd451cdb41739f1886feaa82f0d04c09e04b9f897e02972359c6b15dd661a124128a110981b239721afc225921c285b044f309f4b5c18608e701953cc98836a4976e9702e96296243d76bcd11b08aab74724772d6bc3f9fd94c6d74dcf13e43d92017aefa2afe9847c6af585bea0d43cab8b9c239d16d802dbe9cbf3b09b6771624f05d073fb52434284408c97c946b18e627c23f2bda2bcb3657fcb929fc49b59913864621d3a7cd6591c9a5801c2335b782f2b414408594117569d29a1d8dd7e320430609c251935b52eb6605496a785a203b0fcefddb43693da1925d52eb9d00f9e84e5cee3ea24c61cbe4fedab3195dbb5beee0fc0e0b15f217961905e94e04202fe0044bd088d83d3e250db34d52020b49696116327397110809f951fc8ebc64527c4ea7ae788d5332dd261ec62fc6a001b5c1c76cd00fac2be8e6199830d3dc7279836d14b1a41af90c5927eb707d5d0a0957a424c5af2adfd5853d1295740b86cf5fbac17db8c50d1aad25a3d76c60821c4cbf0561255ff7a76386d7b467008d6f325c98b4e2fe9784455bb51445bdb6bbcd2ecf0c1fd1a68bfd8b7275aa64298152c0bbd14c0e13aa4443f63f3d2e783ff40b72bbe1446d46eb0e15f0d5125285340223c29800d8f4e47cc66d7080550ed144ea12d0d9a02411c50dd2309b16a6da0e8241f150bc78320b8e371f162f6cbd444ec246673a3b5780f0d37c2a7195b77423b2a849c09195765c78c3f6442a2368509b450833de080ae567958d6278c05147d914769b82736839aaa2ffe172f1a3688ce0887c347460e467fa45d895d74325c66e8bf3e406aa2b3a29d073a4d423a600f330ec0910c19cfe37b58d396ae8b4c9d48264fa1dedbf48cd6a37570529edf30793cf44422c72f241a23c0f49f6b3bcb3794ef20f8b71ce18d02cbeb3fda16e4f94f50a21133d8a5ca030d2b80dcaa0db541b267cbddaf973cdb601b1a11bfbe3cae60570e8b597900aaa52a895d8fa9180f81af4e33ea7fd69417bcde6cde26dfda34fe468fcd015fd92e76a4427726fcb709aaab8073afa4a0fbb1dcf26170a2156707dd237858556eafe8a037660f85646e833120fc08307a93bcf39793a6fd12a5c75c88448f55c28221c837bc49d3100d8d5b0a28cdccc196a3c4f95d6b9f4feadd07a8fc07640eb9860cb5a4f7f0a3582b1857f5dab5f315e070db14fd496e2558f6b9846b789725a7c2e0d5999716f8d57419967d5156ff597d0b58d8b482f76a1ee0b0d1c35949bd1570c5fe74a15e414499179125fa068a14429d2dd645aaad9b1ca17bce6af24eda309986e73fe26a8bb49fd2be5fd7a9971234d15f0740c400977c14181334e8da9ffa59e877fa0ca594d4621689b3ae7d0a0db90d73c8e121ffd3f5d1f5419a4d8637fda93d45a177d918ce23c6e7b90d78026e329b3e26800a75da62067744100c1703437b0ff77f7d8cff1ea28785ccfba106597beade2e35d2e2daf06fb13ec97c210c674fd6840d6ada0f84d209df2c7880fdc24638301b6f9510341fcd4c92d51bd40ecabb605d7d862e985f2746c94a683ed21d55b071976c1db2f9c4d2c0b7de6518a54777cafb0aff9973298743694fcc6cebf5725af51ea17b4246bb315718b93fa190dc171bac70c68c49b82ca65b61f56feb4726467eca6e5d164d16bbdd2caabba3a7878fa9cc5a2e8912471a4cda302f42abe7d210ee1a5221ada55705f25901753e82bebc41cba05f2fae7120733a560152e195a521362fd80f212c98fe692ed75c1078204bdeed8f0181c9c74c4664ffdba5837b8f23593ebe929689afb3c9552f1f2961565271995b80458b1d47483982958648e33d02afe56a036f7303f6221420f39258bc68ee0b1013b95342e482098589b5476d92f1cb7625b10961e08b839a84646b108162563ef57bc1f76b9f6f59dcae94b6581e2a253e8905bb7217ba7b49b0be80ce05d3e3d061f13779258e9ed68a51a0a87fa6980505203c03610e8937190d9f3a170daae7827376160894d9ee3a9229f041fe6030584e1655de45af4c17269bd872bae9288fe494ad6a69eb0a42e0380921d78f3e6cf46982fea3ae402e6f814f06ac8f796d4279330375c545c68e6a9313eac4158a8413f7f97b84b13ae9b1dc3b6c121212663715827faebeb47d5d9ecb4447ed6eed56a2b5c673e0ae6e14736b40b5b809eecaf7dc67f729f7633ae008968a5d28ca90113931da6a9353e9b3c7ebceb96581f8ff67f112378b72ca8d739c782107f874ed0a75a019828758d3bbc5309a55c1fc9d6cc001501e918566a50f757ed80aae83c35854fbaa45dfacb652b2ed7c27e637e6df5cd30ec3c9daf31f1ce068e1898dc4055fb562147a7ba0f996b3f546c1831858c906e13388d966e806efe3fdfa21f72e05b2c3fb7245395281d4f293c7319cdb34104f8fb607262a32802904ba7b050866151f9e0dfe692d60a761e66f49fabefd2a49fb57dc59225ef179cebd2ef205cc5862e5e4f104ebd740539d0ac819484389ae2b93c7c0a9b7c95784228a5d2ef680a83074900f2b24e75befb8642009739bbc22d8dfa83d52610178cfe1331a7d2d2be83aa0a7dba8cb9df8b7667098791a61ebbe71fbf25d56572a6a6f8095121c1357e5ef05ae81d06f285b0a6b5c445487f5f21fd0c1b75488072b72b2ef86d7e6144c53f1fb136660dd9e7ea593189dce250ae0ed34e02970e2c0935a6b774a2e3d92730a3132b18e9168199c8b756cda3f4554d7bb375f2083663c3f3fbce7369ff68ccc82ea166173138298941be0f13f730fec866b7f064d0a2e58189bb00565921aa9a38a71832b7a6da1a1c4acf44b73d0ebdc9c6dbeed57ff076a23640d10f971fe379b3a48cf91c6455a4c351d5b8f9c748c5884c3bdb7aaf77fa6b7bf2370106b03b2129dd1ebe442e4c68a11e3daf470e2de6b069890d86f0e6dbcb8c788ae8834847ddb2d5ee057a4bcaf6ec19a19176db0277f60edc3f405cbeaba2f841252afd433974c9a497b9ddc2ec2ed3839ee446a707b7adb730ab5de731f1e80fd5dd68636e42623f34e961df650dc326af048e47aafde1aec58bf8ede85dd16268f160be893651f4cfee805a2b784fdeda31b78e191b7186cd0b0d5cbb2dd36182b1f4bafb6170bfebfe0702125bbfc117e1e5170656d1d334ac7126ecddf90858e8bfff97c074f587a4086d375226470e4de6e061b14a1ed9d9ec7957d983d0d0122dd798b7eee274dd1abb67c5ee1554cb85d83321d84914ccdf1a2091d94027a6cfeaf819297f6ed8859f4fc460a7b28d9e94c9436296cf53745cf2c385d5ff534c126f861c0790ea21caf402bdf70d3f39cf1de89d5d555b94daf46a316c4c8487bb8793da985240c1f6c7ab76ed436fcace2f4144eca4cd1ed88ddfa1692f609270468bfbc4012723581d0e8ea27d0c6fa71522775c4b1dd5b67b05fb6cf533a78438f59e8c045dcc142a27e59d80145c2293fcca6a60437d0553fe54e50a7edd221a2be78f838ef008934e7e8e944332425c78fab69951dda1b8b5c49472792420484f40a0b25d1c8a2238c5bf474e0793b5a14bc2ea2c0503d49bb019b11e33310c07c8b7615c9950788d91b02be24fcd3663d4e4b4eae373935ccf20079ce4531c2784583f44e97ea7dbb194b8a1fe51425feae6f519edca65f1f763c32a866e00ccd519cf052a94fef2391c31f2e48a7b9781b3665c1965a9b3b7c1ef7c06436517b13aee7455984ffc52515f285c0df6ddffde1036da3c50a8f62d585ee0afaf75285e19c4415aa6f18856f82fa3660c0f4f2be851bf3a0c345af52baba6eec9b02044ab4db1e16b04a6886c71b70970598373f226c611ec8b939419e61b7e5be021ee49b78f670812e0332a3019029b516ea048510b9eea8b26ff43cdbefa77dbc58da19e3308976c7ac5653adbdf354b9fe7862f897ca71c752228fae687bdc80fb5e0cfc62b8752ba0e4b0b3eeda5f0d70ddf391443d62844dae5a916213de042dd77c8ae719fe4fce4910789da16ebb74713fcbca29497b5717da5c76a595a2a04274333ecc71186a1df87a5dbf442375bef674ff62651a40fb7cabdaddbd375e7ba490eaad5f4e739f952e257ed8cca42383fae64fd8d5d1a09c9b70a937d36fcabed1905fe74f22014c5ac0c093fe58bbcca4127ad46c09cd6be883b906d45c51e854067080edc4d95f768a6e4a3038b874cb30f289861ad2726a2a446cd3c92266ea44e3762909e1a56628a0cf923cec792dcbeb58d5c6fa328ff1f3b1ba40d942af87628a79eae0026542d371b109e820b8b4b73e51280225b399f559965de786813317e1283a672c70410fb86d990be6c7f97eda26ff1a7c7ece78fbaa50643276de95ce7eefad194139ed4fda626ac0467dbdc084f03ff12e6eef83188c9a8ca16da67844f17423d1605477ca28e0fc799664d67be051c04bc0d9d311e7bc8c04fb5404fb5e28e84bad23b82a1d1a9345194bd1a80af6db4887eaa05c32044ee6a5b906727e405b9b0a36cc7baa5c6831c23610aeed5ee4082109cb06aefbcc4dfe571ee7ca43a4e7bdcfb5fc41b126a41e3e535f78b22e354bbaf950db14782ae4ab3420732f4f073deadcc00739628f64748c477edeea7cf39771027239a1658934b583d9b7fcf5477fe43f0587947bde06815ecb77db0e53d90bfa4791262e7fc37de86b14e301d887b640b129d39bb6825d783a0f32471acde5fcf78a88687b8add3b72e2c58c8e55c006f91812a13e6c370b0d7e6f28f19197c29961da528e4b6e356fcb41b4492bac600386af57fb7a401b07827c492b16f237a15ada1bd8cc4c6c16ccac145bb45ea061ae2e9764a00c446890d63126c89fc57379805563a0e6b19c67a2fdbf221a65f68f5006613e3485027059ca7c39c9194bb4714113dc42ccb190e3787fb77d8b418a04f1a09f30d038055c4b561bf7cd2011a1b809ba8fbb9e0c33eac768944112843e65e94b5531e888a5ae76b40c2bfdef011a40c91986ea954c86bdb115aa28bb8fa712591cc5ac2901b42f7501df7907fdb37c07647283de1a8c9e68ac9ae60953830de6bb47db81cae84cbf473b28cea10b3e0a5d06622ff1b0e883da46c012c53ba81cd2eccc686ad971c2a659e899191a27929cb159769a44a8150b474afe4dc55ae8751d4c8d45cc7a50d3dd4290cd5e72d4644d86411eea4598b0e4a3b1bb7b362739ee5e5689ca57f347f0137c92ccfb227030f07e453cb05b59c84d9aff694219c1b516f00b87177724cd6068615b85c84a67f14a9a653b9ddc54b2055b0300351e6a841d138da5a3c16feb0f1477a6cae59533d2e1787d67f9b4ae02ec60082177a4cc7b11e3a3dd72027f64c20cf2a62d385027e59cecc30c816ecf1a511c3c420a1042e1364f87b604a55a7c699ce4544856a19e7ffec0c6eb08ac46e1b9eaeb85c09239d99c4309c8ee81fbd343121b8f7aadf3428f1c1f2ab35ccf1b6cbb55900b7f3a7767a810cbeaa3ac203ed80f241327c702e6eefa93726cf8284d1783b9d6224ea8a0876b7246f2f6354cfb667f974066a2d633d010419876c9069dac5d3988c113c522621c789695509ac58216db56a8c30dede22b8898c85351bb4731bad1fdd1c30092edbba23c7d2ca358124d95c8a79f5c0776f4a35a0bc9662176f1db71561143310d43994de9c7522d6f8201bab46140ec0caaff685854cac51a37bb151569b96b4e418ed289eae4b132231481e5ea3086bbedcf1d7ce045b3e1859dc7af63ff36bdd93a5a9f29164da8db4edaf1e8bfc519136c164d3a835d329cc7ef884511d60af52715b20ea70fe425d9e0407746559e40c7a66bc8acd498a2df375fac5157719084fdb16e89c326a54d9e8dc93dd810f96e32803ca0aa46c24b9333eca551e9251aad9325df3d5065b3ea9c2291576f05e808c10329736069abed454d6640b14d1771f5f071f94f379d0b65fe6a05c560ebbd96c15bf1e93be9101a737656a4517ce3abe830456cea5756efd9807437caaf59682cb5aec15b8241a21eb118687f513b31e5736e720c325e7ea8d7a57608f894cfca72225449b1f043f76733337693b5affee858700d5ad09bb4516f377085837818df5598de90d70b1fff04a39df5c052b277f7d9e2a2219371d7ca5adb714ea88271637d7446b58b584075c1bda35f9275006d4cbc4881fe53b9ba58092d6bc943a214151331a4d8405994f5cf42e29561fdd670cdb5818659b8380f59d17d1c02a6465c0b44f052be4f7020d746156bab2bd59616293f1457587e60df91aa2b872b35d90435df7c927d6c2274be3497eb81d0ab3d31905dc58aa80884da5fdf8485568c3999809e1b5f6b8e9aa381fee3a615e3d7820bb85a84ac2b22a10db0dd0db8baec6f697fb212d29f675561235e70d6a056e216d64ab8ca0462872f2a4ab431e6ed01a280e79e11418bd19f0e6e619101c7a3637470dd4e749ff0d1cccbe0357897789e54ffcbb9a4e0e6ca825a8ed8b647fab1186bd1e3489f1936477f39b60c0da18546429b1e36e2ebfb8ed30c7c4fc942fc208e0b05c87faceba9307a51654ee0373f76e7e8a69f649749ab518d020bc66ef8e0c3a86834f93bfdc7f89807678cc4feaa545c28b5507682e050d32c7c189961a4dc13bd8c8bad527fa81204f78dd38cd714256b3f9b918d2b07902687085ffebdfadee3076b4d3bae12ca81f07cfeae0320898510852fd6f87eca9c93929638becafe45a06958e9282ac540c773cd022f58d5af4c40820819d4c69a7b3c125c9880b785400706b66da740f119aaeff3c0765d0ba57b00284d4c84a0904447ec1bf21ddec5f292bd002864d6aaaf7b9b9d2d825216835dd3c5400f27252c4bc75104bdf6248792dc6e8158faa81a6427de6fa74a39827b2ff0990f2eaae1e57d57e4e73df60e559866c8914297f580b09405da0cec2ebf216cf17311ed880072bc6dc725dd14ac8780350c1a6f1e87e68d19b3d648c3df570d9a88ff99810a3169250cefe986f33a0f35a9b7327b2be2bd42bd855530755be664e3f413f656fefdb9465bb6c7f275ae6af72afaf3e085f374c0c1b9433f5e56b35a0210d8abdb30c96b67d2f28615f62ca4979cf7fff12320f90ec6ea1190925a9d7a7790a7e3ab36b35760f0a4780a0b1dbf0869f112329798bf122273ba15605058d7a5eaf276fc325ca7a1bfe8d35975a71988318b4999a109fbf8a8a2c9961b365d7fee9851b150c3b7ef73433508568088745daa376f63b1bd68940793e5a31851cf6c06d30b4ac56e29ba20a28409b027279d4720a1bc65e65e6555c2d83d95849d3aee0c11693deaa122e2046e24e056122ab4da3c2a71465d3665b188c3fe28124a6d0a1b1d2800ce5c1185f5b0792358d7e3c6e4350aab7b30750730908a37c783144f12036a57ee66e0a23baef268c44f1441438189c835bb5e159b536b435ba178ae7c3064b306d379bde4c7eee0d88858becb28e07e65b05d43fc7c81b3c85fdf67c869c3cb930cd30e77a10cbcb278f9985945edb6cbf60f6576f410836300838f5f190707d2508e5249cac3c947330696732f9f94dc35727fb817a815425a2dc6e2a19a23f20415a41d89db26108dd74816677863c843aae9588684a2ad62eca057294686097c6ce2cdec6b58f00964b090aaaaeae44bd8ca118ac925acd4bf086845ec9dd4901e48e77bc1f11fddd4e6de74877d4e4f5053898471d0ce4e0cb45ac63d104bce45e4f00691f4826e42623b1030cce5f211cf701f457c2004b62713c67335db207cb966ad56bb4e4e873c24ff809842949d6d7cd530809b55be6b9903bb0bc96eabff5955ba41d913e01d8282d8dbaff67ff9e642681320ed4d7f909be6e33449d72d5b14a79427126e1bcc512264cc139b593cd168ebd73b48fe54d50b2e9b3bdefb630a791ed5a35f3fa3aaee95f649a88cfac82dff3f3588d15f24e7cd97411a767fbede70702d6b1cffde20c019887c97aae309e400c3b103f28902ce96f56f3a90f5a24a9360744dbf4a6c5a2e53d6348e63e3e8359b766df42eda89072ba37b386014d44a570211b80b8d893d4a55968537c22b6ad0bfe4953c8a94f3d187f790037b5a7a30d3ff2598128eb261f33093bcb419b87925dd38d813b1a0cf2ae9a5efdada967431a8da6e02a811f55746ccf39ea58910bc939cf9ea9b4c0df1df65d6545821b3279da4d6ce115136d9a45f52498adcc87ed32d6f3ea36e678e1560d4bf909aa29d3e0d3c729b6123fad3a29302fa6505a6107404521c537dcb10e44950f7265697551721915fdfcd3d876973656a5bf0a8cf7ef7ce6331255814cd3195631ddfd2ddcdc573ec7605f28eea1f079334b17e2be6b76fdfdbebeeea4a78112100a0246abc569499914ae6abf66b689398bb6bde28666751045bb174e3648a713076577e982859157faa68846234596b5635356b777f0f5cab67c680ff8f3398dea37de7318d1d45d9ba3937b2f3f97dfae8a0de1a5d15caf5a96aa2095f7a146723779a2f0e99ac70c305590cbcee23c0a8075bbf34fdd3b11b6a42ccac0c84c14e39e95fd31ff97ba7e7e88ade4b5249179feec36441e61e7dea0fd6c4eb0aad68be8c6e581713ceb3ba95cf357779d0b6f202e86ca6a39888984fe3a57355682c1faa87f24a12766c4e5698705ebf139ab633d4e4f404ef7a2f27973a59d349e76e2447e03c7b1763ceb3da64dbdc8433a2b0afd18ed34a352425c5fb6b7fb6f8796d69cfce3f580de39eca5b320d1c7184b27e559d00ee0ad272cab4275cd4a97c7e2a3dc043e8a6de2d8aab9c025a571cea88fef7af84755ab8907e6708a6f0652c1333ac603cadb1f4503841179344caee2872c637fb35557dc46549169743f967b5d2e9caf1b2d4e701855aa576885caf8f0c73ac2a170b0859dad6ec579509d27e83538dfb746ec683da5ec35a12496e4f707f7753d54c74e556bed5e0a549ad14f85d27981413032f0e5623f7375a417ac5d5a1a8e8a9e56b5565b5cfcea2c34462d1189a95202fdcb480a9af497be503d1dd07d07b82816e6780cb1ab9301a7ab1ae77f8f8bde6ec3e069158f1ec2d2e1640fa44d738f6c62db6b7cf5afc0665eba5609dad6f5522fbe9ee061e6c63c2a405f9212c19829b991cf4d2dbb6ce9d240ff6482424a741c6dbd6ff6b5c68a8be1a7ccf3c12162ba8e061468171a8289f08e4f2ea2ea55099b24bede764a15e438852b99364269bef3196c44e46e2dd4579a85b8ac761c70d3168ec411c1bc8e30426a6a12b0a02f9d05deb3fc3f092a6729cf68dd57bab3450e4f7f217a6f0e23048d822a5ed0f23c77aef0eb9926d46d42cd260d0f0072236866c3dac569a90326b1726d72c7e2d72ae62d9cd9ba5af08fe383cc6b5b36ade533024ce84812c02d309ade7d4c72819be086462fb68e142749f79663b962bfcea273c2a4954233ecfee719bc33b80e41e543f7c2f5e052229653347363a957a0bd9a2918470d52b1ca3da7b77f6a54697f47e963a3f3522ecdf2102fab8efd1553e12749071388a69ebb6b984609f7f156ebd5354c37a494df215594c1d8dc6f8e61243408b40ec2e7bc908b3a91e7bc2b7727b1b24af55afa9d4b5322dbb12f9eb484bd3b27fd836be536bee8c0838e2e3429dcee83fec84875412e94858b6702206fe1709218f9f16d6bab5661480b8a2b2a6fc77ee68f2f4e30f71c1dadc038d58be3fceb55cabc68fcdf11e57e13eb22702631f6e062e99a3be832ee64610cebf3fa4404072eae94f4b751939cff35f560d874a47f908ea6968c1027808e3969974c35407f0664eddcb3509621648b7f477b116535b495626484dbc572c1c49a714539ab0e493d009653110c553b692c5decf30e1af819e2f90da62a652f06a6b999341828c87e3ff61221b643e2361c3d7afe96218a05ab9c439fb23cc0ca4a1efd925775acd0e035e695b5deadf39b4975515a2949d861e2cee119f79da4c2e74e0f9a5897f5b754cef5f9c77f4b6f3bcb1ca445828bdf85e74d27ade97a234205c856c4c6973c5dfd14aa21b9484d9a3422b3419e7a98162370ecd93b592bc131c70364b1bd793fd2d61daa1874bb941d21a1b86d89d995714c95c31624f01202106c6e15d53c74d12439613314be523ed4e4fdc0a24c91ad5d86c04dd1a6bbf8e9fe41b0356f569d51a3dda1f2652d58778db532bcd160b490765db831f99adff1c569d6f91a9dd6828e090800e736d23ae1c5e3e8dbfd0e1a1c705f8c2c5d2fa0c9965cb5c667312e1ea252829082a33253c76d28f10f0a2747d293c018635886029c30a2da351b6b3c6544d5f69ac4a3de3818f6075a8c1360efd0998f6d58dfcfe0b90efa63bb57c4b47b81dc66c20b0df1deca6f62f8b439b1b49685e4d3e905aea5d5deea5bb7e893838897cffcfd8e3f3534e8ab2ab2e5b0aa0468fbbfdb65873cffffa06e465b4da2ef8bcf9835844b94bf7eab8d48e14e4c60c0c1a1b4e846f217ad44984db865dc61ef5a837ba7ea3fef6aa8f37db9ce5bf2003bd56f848f07dbf0bf33438aacf273f467b77706394aa0aeff0673789724a035d58aafec72afeeb20b8a302fee6c08854aef629d17f2f81edaa71f451120f63a229c5caa4f16c7a6b6899985f67c05ecff5b21868b1ce0f9ea68156ab91f56d9a0ed017ff456f65a8ed8002a467433f72f78d33e4db5d945f33a1635c989b001dab2c31b0308f01fc4a4fb3f975e5881951fe8345e61d5260d4d3ab1c0ac462ad2bbb783ec834851cc99c1fe462e6a3f0c9283536de04eb12e627ccd684e5139c4a5be7290335db4f912996297e264c508ab5e01b835e2c19e331c736e801dec93d838c0908c3809296e7c47a3907d6cb247399cc541e6d3a9fa32acb3b6aac472dbba50589a52371dfb1d9897b6d1216b8173053e2055ccc0ffa8c163e20ecc1f289cfd15c2832b68947a649f0cb6ecaa3cd2c71f99066585d4a41d57026f68725a6b8c2883d60c6b1a50ff949f373f0bf254a603f73e62f0febbfe2cd1eb73203686b115bd85720e52a00fbfa9a2e31d2955f51f2cb0f8f7f8fa23c320501dcc98d4fba037341a627b37e7f7c6c72ada39ee2da1f9beedc4ca3e628e48ab4c7b567f28498db0f021540bfbbfac48501efaa478aaad3e4e4115296b4205d2d9639c3a45a6f0fc23ce957075155098dbea98e9326764662ea7622e1432532ea9d9ad7d50822aa61f86999c6b674b862b69eaa2321880a1c45835af4aef14b4723f7039b4db6a94fc1ffaf0b92df0afe8008e6c8f41bba2749f9cf9e6807d735762d4b08b79dbe4045b871c77403df4bd63ff7d8edbb2a445b92a4a042af506613c926bdbb69f8515cb5c11c80f7582228e4a481c507a2d29691b2995d6bdcd8894ebc30ea733983fd255140d7592a827d028e30ac64de758d244ff24a0b8e2078b3f7052ce749dcd9647ae3148fac3adb64b7c11a49bc2c4984860501aec32b1c787c3b05b0716dfb9d495cdb0dd361c9e88043008357625c06c333e914ed5a2aefb6ccbfc264801974ba409bb9f92abca3ee53b99a3c0f152ac0190572150ca8a93eb82970e050e7d802c0911249413f60a781f56b20b1c3f6701117c52d0c4c4d39ee260804b5ad45ec1500d2a7086ae2d3a99b51805c70575dbbd159b490d4555c87260b8531e02cbed77a5d5ccfe6410392f0d3ab235a3ed77a3d8b0fdee41095062e839e32c9cbec52404d1d5b02ac6889445b4f77872ad0bca13243926f50c72f149339243e177e2670b48f2e049e744f146a8a6a197c5e4151853d68b9da2f39d315e6088d8c102f5481aca32d798406de8b5e05d9354c2fe0fac9b2897d129dff0f81625518c08482a189ab500430838ea3c17595a226d06d47ee8863e85841539ac0db37ed7ffe38d284335bfa9720e0df79b1760e56b6462fce52531c1994c7b90bbae62752295ff77894c66f0e747bb6f3047b0b25c07b12972b5b782552f87c9ea1383b879b36b691dbb0de7e1ec75c7d12aa35ada26f6c915216b65df8c7beaaac1c365d6796081ee05e0298ccc2ffa52cd7aa532ffa3ce2e5fb57282687b50ab310bdb86d72b1d747dee22e56b8b7b96453697b7cfea9467842f6e3294c1f8ba2229a0089ec10afa0c89b06a7412acded7f7356ba87169dcb08ec65686d3fda0f0b71e6ab44acec0e47e541f8d07aa4c86a6e74b611cc13f9e81d108d54bcf7e27db2038a8605297b921b43955996a208b893b82740136cc580b5be4ebcbfc77a6bfbed9f995cf5e502f619692a20028a9bbce1a7b3308d23577b55bc35ceeada70a623769b5b9bb6d952d0be9361c51304a2e245d05245b17b1288fd9d422e0c4dec5da9f156e04148b04c4635708803858d8ac1e7fd6c5074af36df3fb9872158ed258de80cf7997a262722cb549c9328c38a2c6269df0a9c3838ff06162cf87fe14fe350b2d49dde08eb2e73ec97e04e64213efa5ee678ceae2022bddafcbce93b7cc7e3c84911fad7ea92d65fdfacbc28978fc354758f0f1cf7f5719c88ec517cbc3df1c673301da9943dca5dafc8d1e1415f004c719eafaad0359eb7ab0bd6fc50378e9606cd8a90028462af515034537474c06c38a44de8820a820fd1ec8b00c466efa9affd7fd744683ef374afed5d7b79c6690d0b7fa36cd70b579dbba0b526fb590d4f0a7dca5de29a8f32a3a2945c0fd56d5af305138707435d47113791dead57b1b64f8c610592c0879e331b751343c2775bb5c13f043b5621076af82f2b7b51c42e3f01e6c7f736e83e91ed4241ebd54840c01dc7c140501d3539b2f4f8b8d802ef28e784419ac42a1d8d24c25eb3d4f4185ea83cc86a76baf949e80aed111d85eacddba79290d7212fb50dda1e276e9105f71ec31355e6931afacf91737a2d770fb9a2329d3a56e06bca179b6b44f6450a2c98bcd5fa3ae47b3a25174240165048cb026771bb00e79a80496088a1bb15dd5c8d496e4ed036691add24214688261be56d1c0769b413e9e181c82cafbd33d800a7fe3928d160e144531368d2aab470bbc41ead5c985208da6bbeddbec12d0401249c088ffb6a4b407d729c91bfe26facb918f5a0f8f60b54ffa6ac7b1d09da02fab46d9f0b6bf2545eb514791c023890092772d13456e14cf2e7847c3c3f9345b3adc23c5ac3382f80f0d0f279859831cadb6bbbff7a1ece998243a5d3fc1871731a17dc9de2a741ee83006d3516f071b9438675c05e488805dce3a4e48bda93bcca7acbc9354af19898467c416c238f80696a8d1bba04c4517a3532f04515be3ed3aa8f88c0b301a50a8a995b19c9f2b65ba4d996c1d93ed6ce819f4d64818ec921c7b38f69fce8e91631d1e56806835df3d9ad9bcb24c396fe654c6d1e260d59b2717039f629ce745bf560769a52c2f9a96ae2e308cc26ea6a13b529b980bf21a471a40658956351dfbb2db82a6ec4b7570f1fe3c3af8dde41e7d3672a8661b89273fd3fa303edc2280a89c62f9706d5d4310ad5167df35656a2d508aa203dca15cf03121fd099f651c9ba82822612085ae7c6b35d8a2731640a691992b51715a998765b2bce6a52cff35123f1db69a18d611e811a132d3a3b62b5f238aec169acb592acd5e908436d81e9434cb09bc6bd08149212007d69b07c58566dc6b9640da2f0c6a1d185d3eaac2d4ad7e1e9151a83f51fe7c05f537a5f5fea99e545b1f939099c10f293a2405c857a0b841f30ff30f811f165a8955b312d9292847e4d35ee9","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"666125d2285f1dab0f009ee7052c866f"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
