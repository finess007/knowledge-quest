<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0773ca2ef24669781d048d2024790e4d0900b2037ed52e56b80c6b133016e84a6706d9cd5a029452b5ae90c7acf9790efb9923fa9cdc734737c3ff60d898d7a2b469515a40e9abf7b374cfa42c64206e693ae0c720f2bd604d039c8073867838aefba87e1c8f06ebd7ae85f615496398eb2cf1bed7e6c51c80aa3a51cdac387755c89dc6dd4f113a9a8568383cb8377ea89aa16d867da8738e4ab4059bcacab72bb67dca26b7927890326b37de561e4230411ac36a2102a70dc08441611f32f496014748823ce2e80efcdba5275f448288c53b7d6ae61bbf8488b35cdbf4cf51312ee7bfa96e48c6de172165c7254c6b20601e0ee81c7a076b9b987c303861a040c5d95987d844320756295ae1261734a6d857fccfbc44b72ae5b681158c438e8ab0926d62d3d535261c8818fc2e6b41db5528d7b087ad81f349cd70ab8e1301c75316f9deb25de5397a2606c26e5b72a13350b5827203dfc16e485667b823b22c565f35e1ea08965f8cb0694f213a0df405b6517cbb78be6583ae76a09677dcdeae3dd6bfaf406d6bcb00f3ad01e31a53f90507e38adcfba4219b96b452542c38b3614919dd557200d9a1971a74d4b7806f7491efc652f0f0d0ddf14c8dadad52de61baf28f482f3870416b9f238c14d5df67beaa59970e5aeeb8004a53c2068ba1547f97c41febb2cf6a831f3f7e4d47b8f73c989ea2d8f98fa3fe959be3254776696ee3c4c5cc70ea06f115a7cecd5a0752b7a0cfa4bda567ad5966d79b02d33bb0be7f9d27528fd1bec1b4d269fb0c464d6452158d5a1af0ca80f15210481f61bc233e22c9141df3ed6545ed8702b20071825019e22b0d3ab60ecf31890746644fe2b1aa23e9666eddea12b01df72d6fab5f6a1126db4d7598e2ef17b7a9866f379a81f95c869c11c41384008d679fc5202384e6e8c2e6c38887b54ea0993b02ce1244a062f117855d02905cc1b67cb875331f694d19b033877307246066fc40a4bcc4310212ca822b1bed8ed420ed49eeff06abad7acd6e37c59234b742d3a45e61b6795a98e710c097dc2f6106091504296c270fe2acf31d7f7db07e37f32790374d63354a45e54c238acadf7c6423b1e7af77016b1c983437d3f6d446d673ee4978ed006644eca6d2ee271c276a29b3f66305e866f96c8c774dc9cf1644a986ecdce2c4294587136a1b987d84b198ea254edc7468ba52f56e5763e32a5adaa55b4e2cd06dc661622d67fb0202b60295b26bedd74c156b6de5743c7771068d043a554e062000a95cdf922b3f3ff5f39115e8398985d053aaab5283a68fea57a7af8b77bdfd0cab3163c4d394accb087dbf5a0dd6d09b930b5102cd31df6b288b66dff75e700748af2da026e85c7baaa7ccf037e8b9a73189dad17464bf5b2d89d170f15a5b039b5d2bbc7c661a9e814c988ce5e49761214a25ca44126cac1e1d2ba2618409b8288580a59b0be92701251e83f961ab147ca4c34c5db668ebd7460b04ea36dfdb47521c9dd6265d1d00b581c35afd00bbfea3a1d24155f9603cff7617524ff1d9a2e1a4f485bae86e8159a71305d01192f7d1a78b8cd1681cc4594daa7b0ea3dc46e4b443d41451b82da5f67e7360233880d68ec04d28761511bda8cc80d7095c9bdd1e7ca8424f56d7595f46fe30d505b5c06c3fbb2a762dc2c2bf62e98ebf1a7e7734cb3996f9088383256035ecc595a7c9a7ce06a5305e329ca10533f279c872bcf4d33f18bfc304e06d56adee4cf6f38e1f6a144358fd491684c40f2e8a6423648f64f6670b9d368f3602a53fd8407fdd215fd07db8b4e7d4f1854896b490c93e309dfb171f5162918fa5f1ca96b3dd7d9a29240eb3d8346b54be8f68f287f5627cd0ba89ae3eafb389be2742becedd014931a9c0ef0ccacd43ae04a314d6a537b728d9d3c0f3fed34ad24eec77262c656565fa409636a2e2586e6b4872c4fa639f6d8963e44eecbe0d637038f966f072ec9a0c8edd407a4c35ff0b0f64c298d93acac2c6403cebd66848a4898d3297848fb602f9fa70105433faabe5b86cd16a2e91dab5e37e66fd3e7d731a3d7d66fc28045b9b43243dc46eb56774634117c54c237e743967dbc5f698cb3ad68a8e51cf22ec78d6cd6fd510c01e1fc597b8e7a8319640270784559a0a59fa4d550df8cb36b657778619ee8706e0af56f7b5f8c007a992c49811e4b440b83b506deac1372a0b70bee3d4fa4c55abe516d81adb8527f5b882044884707f73eca754a48177e05d03b00601ba6f465d63b251171506c1f6782c8ee1c1fd30ed26b2b9920dc2cd98aa546ad26f60a03345bfadc63efe6a29200b208b7e11f801d230779f0a774436349e9ea8e83dedc410de0905401652182d9125ac439cee737e3b47c5c0d422ff338c3867cd43df98f6638c6a7d4055a015e0d0785b156995bb30187bac626b22012d71e5ee374d33fd333ceb56f4623604a0ad3e767d71cee3c914c98cb0fd9c98ee2a4898368bddc9273898428172a93c239c8e34102a6de352f704ab120282179373f25ef62248636691e7245cca43f5696151e35521da12e1c90c8a0bba252294cf3ef6a6d3b261ee88003fed4a7522e0fd40d870f2d3dc50f49df167a1a0028ec42822b2cfd68801b49c1ff382f12a0623265b7dcdc49b2592484d7aa75cd84bcf8f145bf242e73d83ab4c4c9a63a05a7716c5ca55cbd6234197208f58b4c7babac59466b16815130215d9d84676f2ee9f843723ed3469352cd4a9d8a4979a24ff6b0ef13148cd4267e4dd54344de3e7d8d131b69cc1d4b7009970429165b5c8334b6b55bffe73a8371c091bb752c2df559597352637dd8ab77a956ea4a4def79893ffc74743aaee209cfd5c42f827bc019cbc8140811763b70117b133e5aef369ecc0d2d19e5558541c53989a98db1ab364aed5bc6dace33f0ca35adc114dc218f65bda4c93366f9f2ca95594697465c95b9849b99b8c9980e61dc6123d4566015f2fa0508bfbadf9eb8859f375c14e9d3360305d3ce9ee5e6f6af6ecaea4c94c0f6ef020e3b9d3f6b5492826de74fa35b266b6b53e82694bfaf6aeb0423241279f7dcd8b435c1a21f4310462cd4aaa67286bccd205e29356c95a4282b08a3e3a583808ff3aa9f540d7bb878529895c80cc56fd05de7e9d7f016bad0ed5ca390b212fb5266b94370a8f7f85e64945099e91f8ba3746cd2f7b1b48b7914eb76942d142c7b6578ca415fd98b282650647c3f18153cdb4f152810e242e5e8010edfa862ef3ff020aec959600aca7f750c7a76d16406ab6467362653992f8602881e28076d336ce633502e486dbbad67f9b02d278c53775de755173d001033b26d84d8f5c020febf5f205e8a26a39a68b203b25cadabb7f081e01c3daab36a9eeb6505441bdaeb878a4516f4a20cdc9c23df00368d7517d2bcdd2256ea26fa4322f374a4c84d45fe5462db244a82322c74924d58a491369dbf3d0c300ce2a4ba819baa66828ff600aa338fd931710d824ecdb7515ae57a5f931e7e1e866306393183ac586428f07291771547033724499dc55da18f254aa0ea7cefd26c2afcc52ef9c7897709a7f100c028334c230549021e54e23c90711578729af2f9a11b91e537336352512988f373186bcc40eb23e1cdacf281fb25bb3c9b297ac39eb9b4a96caf250f87b4734017a64efcd051ea6b13180f62a18765ec55aa6c1c462b595b023b3528e1b77d6fceba4bab9e5f0686a30b3f4cc0916b7a49669e36f1f15fa5ce6418f852baa2f814d7e5b1c32b9da81ab5997acbf372b6171b1fdab5e934faae91509711178ffe877a1c08654aff0d57935c3be867f2623adb11e92f01c2a5c74c584058d32cac1313ac13518399d70fd4bf022bd540ae8c1b489c38c6fe29f3486c28a7ad806a202f3f19339d09d8ab9bfa0f593e8dc5f55339800949810e99b8bc9a404690b1c947383b936e25c5c837c7bd8f1cfdf3208b755da1b0005ad972a9f0f81a5d92c48bd2ddb1868fbc529ced8cb5e558888122207ea746b7898ece1c0482eff1a02a86eed80160dc513758b615f4dcd4634b32be65859ea4887125189b1cb8fa9f829c44a4078c30a2068ece736b59bd9bfcbb96188eff12a68a4d1fbbbaae3ebf0665b1a67a522fb7660d70a84c642dbad84e2e99d2d2369414b1104de086398745e281c7aee50f659753e5900bd258a16029b00d9cfc525982f2d1b95afb078ba74b34ff6ca2d8042528b302f0020b6124c753f9e41cf801c20722a52253cb4b6f40cb7827940bd938ad0c962f823e13d7986ef88ac62c1201fb619fd2cb000078a8076f766ca7d4bc15a0cd1bbac6abd2834e31fcc09dc96a5ccefee90f9bd1d0b75978d57a899f5c5d6ca8db9b53a207066843edfeafb257ec8165e4fa62945a352a52550a3b8c9fba5cf7aa9d17b7529dbf62058225c7d30862f90ce74cda4c33bc27cf889f7310187fc3c42344a6b94894ef75dc5b3a24ccc57e873b720a693785db3901d5c9a11e5e49b62e6b115bc6329a90f0577a054990fc789f68fd835b363c3abb997e228a59efa20eddbe1cdd59e9743201040a622da16a635fb56c2bef5d1e1f11c4277711a6bd32beaed7eb915e468723baa9a17e7aa5f2ae3f87e6f2f1dea1553b1894fa8f226de014533b64bce1f34c801b58d51d2bcb1804f74297e0b8f883f1a691a86a4d7fe44d2a5ce5e1c37af041b06bf4c051a815aa60cd907e8a81ff077ac4a35483c594a8619fb2044a167e341cefcccf6971015b2c4cfaebe6d91c60458c57624d73d9088e4f1414afde32d0c842e05b6b42d9be00809f7af5aae918cfa570bea5e8a3e01c1bbc67f224997f5a46b015d38376e2ef33661b3364406a764bbbf94b5d8c109d4711ac85e807218913224de160d59210d6d3bef37e833ae9315de8d77aeae2c21476fd73cf06627ee709153bcabc772ce3c2bec9badd4c20850bd552ab8d3bd3a3961c9559b9d8b7fa7647378694e49bde86c25f89242e2a240e53268623e5f7240de26613b264ea33af90f648269c9fd4825acde7059f2d29041e2d6e3bb2659a03c61840f58a4ba141b3f8ca153e177a768b66c49385201df2585de998117fe115978de695fd6f9abf8db06a6a6ad8275bb452b77153bdb40bdb03a53fcda473a7bd35d17dfd22acbea223dba97767e5da70bde55a148eb440a7b54b59be1970488412097dc480ff1bad99b849474da2ec4851c9e9a6c13a331594b5abcd65c26d058ab313e4e767294b9482d9fe8f450f92c631f35aaa4ff4cc42d55872573aad62306a2649a7dd1c0e22031fb59688d9a7c03bb07c2605bffeca88ae0eacc4d614e1ba08f9f0a4031f256b9c00cffd36e42f00cc48f0e3ebca15c3fc927cd1c9a7b584fe722038f7f3ce4a9f83e8a1e84b453b29b17d63ddeb6d96ea54c69ad3b11962616fcdd0d30f491e0cb06b1af26f5812faa88b036311c9980ac0441f0aa96a006f8984c472bb65c4b0e6dd413c1a6fe5a9e376ef33241319aefda134b2144e4936fbd8e6337acb46bbb8bc789d47fd9bf42a1947a5b38da5d3df14deb425710d42c6a4def592a203050d97c8c602e120cb6ed769166617f6a0b432ff66f173005e954d8ddd71d877b0f4231fadebdbd7edf50a23868cff87210fab841e663be7f62f2fcd81cb861050439ed9ad6721e93283ef04455ad0e6ffa68eaf418e78ae9798de98777aab90f510deee2b14d03aae01ee12a95f2eab7099455169b52bc1a20987d1b4355cadafde942251328f679931874a36df46e064e81e440617405ae3c1cf9ff9cd4b41373b9b82be3be7694137d5c1e15e1ba9e12dfd6c8b1ca43268fefb244c69133768d1b11904fb612fb5a5ce0d46ad0e84eb77ebccc84330af0979a8f9a382ed670a6450a1a138a775e284182d6c9f5b38b2ef6244a2a9574857ac97816d2b8b5c62f58fd549649e5bc34df6f8c3555e55c4723ca9d1de997a8584250e530373f26d1e009aa468b811824b8bb95d5ca890eb6729dcf904e097abb29e22c8a8ef4ca0d0acc4dbc17f2dbae1332f1203175771871d31d9997c2d9877324cd21c16acc10d535d5a25281eb9d02d8f5b087425ffd9fc14aadf6f21876ec252564fffb8a65fb4e7f30f150efea55493e9da86353fb9f37a68a6bc528de5aaa5ed6b322fb28fa830b3a34a71dc7f68798f54a862345796c8f7914bce9651d5440ac1b8057b27abaf2db8204dab23726e63d55df45f5d273280fb6cbba3bc70d95f973f1c38d93efb0e55295d2fa47487c3d0ce71226a0f121415aa1968763863a2e53c3da9bafb8802139c0d10c78b3a5f314c157448b665cd5db9f539711a5e0d217e7e407611e6ff5ccb60a9a7a1586494ede0a5bbad180e8cc02b68cbcfda5dd1e0b464c0b19a336661cc8576e2dc261e6ec89103943e6a33caaf24dba40dd8fccb77d79bcd13bff48170e19bb4d5c787fbc1fe3ab53813d685da18951d68a80b68ff46cf02084a8d1984ed41baf3ec9fe0ea0fb6bf1bb4266f06ba105827da6bf1ead4a3bd17b18ac9f4cc901bd1b6e4411b824f65724d24bbbd8ea05e8486cf89158a72a07eb833fbc3ec18304e635fafc5b88b1c26eb5fc98a05efdf2cea6a3fa0558724ac7c88fb0da97c58020eabdf3be3d017565d2e45b7b1996c92fd4e099a2585a48d33a16a7fd0b0effbcd214a957d14f15c5eb3556ce12dd4d339a2cfa55e7e4d17b87a3bf21b24b46878e1c07859967ea33ecd80d72b4687639a7e86cee91fcd23e3d72a7c3f1689ca27c3e007c096e783f55970b460376b509e94891910a3e995decd0eecf325e71832bc56b80b00a43b79e8286aeedad100861fbcffe13136c92cf85c3949768a820b862f455326e90fdbd68cd440f7fa52d807c2cd85706a34752a8cf07fb90dba709224f06c210a18b7326ee64e00ef6e240bd547a809094abe1c2f93654c5373723204d7635c827f90dc15a713ea0e575b93bac647d14275d102539d1ed0e58c09a2b25d7e4fea2e314a5b4e2cd24a7cf28769d03190816fd63723bdf59d46a377e2eade80e6a4ef732c850e3550b27bf8767739952b3b186f91883412261fe4126bacabb7c83cbc5712ca6dd0421d58bd0b584d94612eb197a5e1415795800b8fef45202218026258254ae1dd635c1100d346922ebc677fb2f38fdb420f9192cf1796dbba0636a349606e742bf89c8203c0f7902bb587eb4cfe970663fdf5816e612d75785acf6522714dd40f4d98963beb4b73bbcdb599e5eb2717dce145d268ef738e1dfe21a35d1b0758202052f57ef02f5ff47ab67cc4259a4e0edc4d4dc0a2b1d874f23991f7540a94540beecdcf7fe35ba131d369f50e324192d7bb8f9915623da46ada72488bc26c553dbce8f8758419e990235b0d8786957ed402b74172b63c11ae893b1335ffcae0b06a1ba149981681fbf2286b53bcdbd2c5aed495ec5facf8dc210209273e55d4c6c641abeb917f2a81517580a4573ebcb916c0c02ecec69e9865fd8f9b5741a80c3422e1c57cdd2d5fa8e28df6a5f4227b4596773bafb6b3e5b8987e4ff51edafe6867464743919602b4e48312c4d09288ccca51e6ed0ab9c1bb23709af31a1cc77d9f66ab01adeeb5778e53ddade29f6ef8c24deaa6879c73c0c0c183dc913d670700d4f4353aa73824f4e6265b8818b94a8aa15acc43c5895f978a033beb9baa775bae2411a50e27593c9dcf48e76f83f36fcb24ef80428651ceade434b777f9fbdcccb34d54476d85b902b1b7a6a8c44ecae53eddce56be2b52263fff6576c190ac0c3de65181700ab6de805c1ca273ca3aedf97347f984e79c319f25eee018cee427a8de162ce4db01c62de6acb2c1f6fecc1b4a8d2726b9977f1b7ace5cdcc9915d93b13c0e2f254c36404e09c4ec8f944000dca109ac62503048190d931f91366be87305c4faf46e8cbb6152cc27d692d92fff136571374300e9536df1090eeac50f608b8d9162e9626cdea7fbe26b1c43a13b84fe7bc225e63a97b3045e8ec953b1d82e1d0c808089cd287ae28128199c261b81694776b6ef72a41b46242ac1004b03057e47f2acb51ebfd62ab304c7543144a38e55a21f887cc0f8caa064e1a75a3f1a236f76f166cf0a303b3d5407307b667c53a30d044049b4f3356eb1b75dc190d610c866f86113d9a18004b11db354f97ed04061fe4efdaa4f7e6605de7c0f650763367d0514be361f22fbdb34c8ac8f8dbde5d24e66ce1c750a1f4249124a0808c0cb097f1b22d26cf073e41c7cfd6c09a513fcd1e4a8586155b7eeb27e7dc7232c8deebc6b561b9070e4832d2288216b776dbc997098836aaa97b962f7add9678237ff1af89257be0871eefb09c71afd22f1ac22c296d1ebf33bc55997c2942f479e9dc85c4cd9c0a435b6a52d839665ea55ce3768b6254a5a027302130b5d590050a93aec249d337aed512af3b7e0b5cb2001b96de5522f8a924544a08ff56359cc4eee018415bf25a70bfea1ad5176edf6ebec072cf12e9332f000488d892da2689c486a5e10ff2274ed64ac92fc9139a9216e8b92d22d0d82d1c36537b2a4e6509a1b54f509af3db8ee0978005764233df3f1e6ed1ba3476dd4ecf85f0ddb96fda0f047952eb1db15977516457510f35b8e47e60b8b2c317898aea1c4139baeb324e0814494c5cbb2cde29355953dd6a7456b2f434e2747592f515ac22faf13e5542975e1b83205dd458ffbbae7a779a269713edaa898704e5e7f75fe20ef6ec3c13858edc43fd5492e069e7b8c2a8ebac651dc00219bce14073a71b12c9645a2285a287c5fe0ffc790336ddfb426a7599cbb1c8eda10c0abd19a3560f0bc69ef047e76fe279d6d65d26fbdd5ed23e7408e770966da3107de0c216320dfb9a71b6cf8c0b084148f653f48cd61c2abbb0adf43353d41b89dc63215fe5d2267c1c4fe42c24d9dbc1cfd848595c84674df4d0c8ee998e46e3741ba4b0f736d09497534a24414bfa636f7e36e1a61cd99fba0c42cc9ec7cb1aac83e0df171cb41b1383f725401a0aab01c1c88eddefd98ba0182be54811f81bfa317c4691c99e581791eb66654b684d78451c6fd679fa31cbe4430d411ade5a33628e3e7ab82d1a6249b408212ceaa7af5b3e4d5afd15fa4e6cbccb4e1c11ae128b03325601a1b0fb658f5694b58799313407f2db46bbd3f2760efb6aa8896e6c265eafbc99d5753571f2b4f5ed103e18860d9b285cd203d1f6d1e362374cc4e0457967b0b2f30da781cb97a455926b218c56858ba5e8188b144b68c5d3f05126c9bcd1adf98aa8e9803008b49f8601598dac1d6fb2c55967e7d93e14c032c8cac09224ac5e396525f446d1941e7372a4600814d85df714ea0acadfab4606a6e5d6ca4ddbcafccce462d2f6a8d2ea48eb0b25ca91e296b4926e54513d2a7ca3af78685e979d2e50e7635ab4cb0d8862709a8b661d7c57827caf99c94601d70fbc9c2b2ad06ab1d1bc78265f005147fad894964056f776376eed32ae7576c16da8ba1114ed5e2a791c1ad18db862132544a6c4fa01826c008655d5f2aeb88d2d5d765690f1e631c3db947c8b5634d6c0ae65c264629996d308a4352328059fa1285eefc8e0e7ff31453bc0ce332714c86313b0ec42661e6e26905c5476952184904185013dc6379014df4c6fef930fde6da73f7290be92cbf011ab06dc0241d89375c6ade4945686b8cfa7785b846e91fe44516023f4c9ed0fb34028b1878f60aace9097ffbc154c5acaa9f94ca84cd77a1a5f3534f5f95346ce4f504b2fe94722e17f365a0871ec31dc31178cff50145b599b39f070a0980b7efaf8df4c7a2c15ed0ea89466ff2da4868c099c95480075650da2835cb91d2ec6495ba62e8dfb424d8f5e6a676a59faac9995b1350904088654788654f92ddc717e7909765fe1387c5e8b1ef864cd9f80b9c45b8d78ffacb4819b94feaeb9d25e8c581d26e923988b8a75ade5abdd1f30db2e7e6a42fd5e0807195ee06c0034aac5b1fd40f3cac94ae0535aab77c471a3fc8aeabb6c2f0e8775c281aca7d48e7ec018b57a3e8ae8c09dd21fab522ca6f2edee42c1ab0a059ede18c36b5a51e094071f5354a96eb26b703e481f212fdb817bf2b513eaf07528db812fc08650a752cbc38397f2debd677598a82a059d8841e4ba00483b98ef143631c59b719408e9790124d907bbd9b7dd58f721480dfa44ae1362182155bc7c040ecb590bf0276d96b1e1b13913f6c9d50dc1762df6b413dd0d01ac8ef8d64dd925c4dea0ece68b89aa1fc994e809e1997fd86908de280cb5661079b2a18edc5e56e7ec1bc29db160e128d306a9d4635a5679891702c0219092068709adda76af9b8f5f855e042c5c23bac5dbff48640c22d66270c1eaf205da4687edfea57a826f5ed3c2a0554f8e499040dc40728087bcdd4d49dcdcbb78427f0c8755301c8eb57ea95fe5b5f2f1f6e174ece5d354daa760df484aa09085ae3d2191f4c6bc7873475ae4e7b5522ff4d75b493c11da3916b875322c150d6ba17b78cdafde59f748235276a8691ba5eefd28b8dd752f37a4d2619ffeffd3d1267773a14316166bc3607dbe9a151346580933bc8a5997398b69d0fe96e53169daa6cb8e8fc0bf181fd3e5fd7cb7ca8808fefd22abed7c73fcb42927bd4735152868f6eecb491a17b384ecb67af00c49e399f3d300b2ba9368481fdeba42cb17eb6b35df1827c000aabb993300ee5f118500088d89d37c96843814ada4b958c7d99ec3cc87d085bf2517f8cb2c2813f642d590381733278ef512f119f9a1b9999d78102a3569cbb821b5037c8e9ab40822ea162ecb4a47905cb6136dc1284388088c2b7200bcdb2854b0bac1ec4599be40cd7b7dc1232ec14978a06f83bb5a900b34d7c6d5edae7d6f74ae26e9ba0905b0f8dd54514db60d92f6280298acbb69c6376d49e0c6e03713fd8e5949c17f9de2ec4fc5b6612cafd20a3c4276690df99cd9ea39e6a8a7522535ae117c67a8cc04a5a5d344af87a2a262a9e6d260681b8cbe280f09c54834d76918103a60b5b6881cb8593de6d1d690837c805f973f60c182fe22d51bdddd502ad67bf1e37e202f407aeb8467f05a69fa7a8387cb487714e2fdb186fc983cdfef527d417b3812edd52e3a4fd83a763ee2c5e9213e880e3b11f45a2382cca8a9d9d0f0a081df44c6e8c60fb3f1edf4ec35104a4a6c37a5a37f3022863147de65c2b5972fdb752e368371acd75bad9ce3622542bdc33ec4e154c4372b46b4e0e7daa1a4914b8e326250d8d54974dd56e81b4a358ddf25024614105432255220f569e9c2c9bff138162dbe55709713408edef7adb9ad448d4734d3210078d5b507f1fc4d19d6b8dc2bfe2fbe362b235c45dd3e662500ca801b0856c7538622e73dfd28f1e33c37e84eee78cea7f6588beb05db436d439ad6e8991dc59388552c31ce2719bd97ea0c1614ae9f1d060ff0568580e10593c10e9cb0c9e71f588fd61e26fd573ed456e514746074f81397beb953e235d87d3f80305f5bbfbad12f4ff387fe954d5cee61b3a46a304d7c40d1caef5423546628602b239d96e869246bc784809f99a458820ab69837053477751de3cb2cb81f90b3dbab409f69f7332afc380feee14f561ca2356ee82be806ad45bfca0487f18f93b742a1999e257a3168fb15d41b4d3d02294c066264d7713ff09e998d15d063179a4de9ccaa2077e27b5b3ff62b70f62908a84073d0822bdba5201660c10fef04091d5ab35d8b9ff10967ddbdea13c1eb8b50ae788645d1393373315c1ebb30d8734136c823811c18965326dc3f24b432e7731393c6799ab9ca594c486913ed00b586cd4c5c12a4f630a65c4b14ada922b095fe6e59717c6ea44bf448bc34d51760f7c3eb0b77d6c9bae992b31f30f0e4d2d2e327c9f29b40ec47f15e42d17696d41987a88591e5171391a9b06670eb6d1748197959be4ecdedfbe13580c350898a630110927c0e8a5f38bbb803028010c82c5da1c2225d92f7e26f50decf310c6f986263fec3a6879ad392d44dece9119a02c1fc0fddf3fbe51f89291851c8c75b66eae0ec48797486fd2b924c64c7231fac1cd47afe1d65d9b97ae1d518e57148ee264637340ef481813883818ed6a0612916e70a7eaf9c827248306c49c72c0bd9850ebadf42dc9ec40871f4ab0e707b7ed4063b4a8c740b08f142263c35331018d11102675ca6a5df4d135e14123952eb03e61b91b1e4665c720ec41912d98efa68e91d2ca2cba3d38199e1243c698335a1514eb38e9a7c4987621fd960725c2869d2d8828dd243b9de906aa5deb392729f44d0a0148dfb91b2a4468ee8a96860a84773d5f4df9bd4a97226a78e482ca333d8ff72f69764f64ae4d49f31fa3a7e8ea9f8ecbc0e40f44ef00f66e623108d80b02dcd96cb2bb2eb84dd9f841ad600bb3f094cf3b8f65b0c87c2d4c5d6822316235869c754a36edf319c813713f375446499d29a13ce9624217fc3103abde13770b2799640d8949edbabae51457802b14124c1ee85170995e782ba28abd7e0f849215fa5e0082970cd04d5fc2dc963537dbb90f8e5f4d4575d9606416b6afe2063e9a2783f6323f53bed8335ce9f5637398c5c7d5a8da686a13d466f648132717753045a7ccca88b4f37dae69245ad0ccc7210442e9d28c727b52e3487129666064d461f74af13ae82695e185c719340b52cdc56eb419a154c0f28228c1cc2c6ee10562b3f0de9ad104e57cec1441e632b968c1f942c3ff5749f1583aab597a3423cad60e5ef2aa291eedbea01d22e70053694463c8002c89e94baf851b37bb57169446f5f6315c0fa8508ec08b62892d185eea23c51c4ceb4205249e4b306c6e3dd88cfe463228e4959a9a78c3985336682bd0d47f86f244c1cd229b4760685bc1e69aaa31d29cd72a49f475142bd41ac10cb15f30b2359c6e6a7a29097b4e1d69f6125eeea0ca1702b65b7b1bf40edd1621b761c4b4518eb8e5f9dbf843a0a25c9001c2fb13ca3c3a81766536b41c4916c5991ed1d1252ee542d94e29a990a8088e7b541308353a77b69dcb1de087f142d6c9b4ccd03137a1d7c573e019c8d82b74a7a7259460297af9f0eed2045ba4be28d0ae408698d74e6e7951609cee85c985c832bbc87506c7a5c60ce85343bbfb950eea92c52d0ec8087ce050729b4d29410ea56eee0ba70d1924f76717c960cc1b14d58c16e839ce200fd5bb36b25c4d79b51b1fff5011653159301e1a6e732a463d31938fd793eaa43a8a84687171acd45f476f8fdb8435143a8ba352ad462a91e6f3c01ff961a452dd9feab386ba118eef945f0f6ad052b311a37b0bf73862e60b746231d45b88b09f47067c274630ac80c8b85650056f09066053cc1936af288a11763c50a4d3e86628d9f0ac317ac76fe4b8f148a627f046481601e81ecdb9d68cac9f66a04fe090e728a88f3d02829f2d23add4c17a17545bed30334850f61fce343b941f9e3236142b5b5ea4c236cf323efb5dba3008a776540bd06f7c26961348a7f835fba36fbe086c702adcfb1aa91d4f5010cbab97853bb5f4dcd6aa257e2f6b943c01150c55e9f198df6db63367a28b9a46807e3c66a70b7a015005a974e5f6b60fb735ba4c523b4950d1ceb847b6da134cb97b707bf749284c4b759bf2830db7840d6f7009f222c169c4bc2fb462058e933e603d65d2084e624525b0e540acbdc7951560885f72ccb98d80c8e32ed31dccc1c2b5556d977927e4ee4cfbc35a4d8710c82411f3f54b26398cfa1cfca1ccfae7111ab8ce61bca584f3e9e0acc04dc9de96f4fac5eef00cc0beba77b5afd461a5dca41d31763f79b3c14b73763be88adb10867a4a18e2d17c27e5b67b012364de80335490d97cf67d1a2d355e12c4ba4e3d1a6c32588428c4b510fc80f745d15e046c05023325591132c4f629c25462436ba37741895b5b86ecefd31546bc1f2b574795a3de62cc7de3937ac07cc1cacc75e7a999e9ee1b3079a9f8535c01a76fe2f96ef69e50ca4b43b7e5c8882931fa9f718fcaadba2a87029a4549e4375d56e28f99faed95d8c775b638486341383c0cd70010527869052d983e5af4d2e6e4e1b5c2af3bd053250f5b72b7dd3792bc895c27fca95481cd4e32b0f66c1471174603df2555283ec5d1f0ea272e02838e2cff48f615cf59a2c6ab098620dc265cf999d6a555d0a9f9eaeb51b5d835438d55c7aead9a1675bd50849f97f64df63ca97509329acc10168934d093b826f1c562af07feeaecaef71a2360dce72f10cc755f8e7392d2a5572a1220eb793929cfc766d35078e66b5f9981dd5c0c7979a28fe05be9d7c1346a28adf409ec97ba7722fa8ae1684f9055c7e6c242d649a2398c622475babd02d6a2c995cd5ea9e5e2aed79b305fd3f864c1b8a32fda581c6c8af2d058074c059c962e424b3e4cd37806788c8917e7c412f04dd65e33738140d5407de7aa7b37a666356b7b51dae2911521f9ed996299f66b3dcf076b394830d732a90fb0a5272b305ea5df777adf7e22df26a1d3ed9d9414a231438c15d7a39a1a4044d29209ffd2385562d4258e1a823f3b108f71a770a0edb4fe5f18197260cb8a3f00f038027e93e479a0fb8065be0b76834036c88f0d8fad77449ffc06c7f4760548ae7b238f143eb5ecc16096b9adf5d1bda05a63386bdff6baa7d59d117f14eaaa78f81724447baea484e26c0c9d692474a6c32db8d4e476c9fe02077b45996e39e70643675f4405004d76964485a75daf0eb94a95695ba59ebba340109628c2712d3683dfdf65fda7ad25c8578943c93b935ec6124f7c0c6f909736dd89c35a9d53858dc9067e40a120a738f8ca052c08ee7b2694c1b627c5bdff89558fd3304bd8dde4f572520e62b6118a0acebb116772785bb682c0fb986522531cb0cd2e83208f5733e8f368ead57f1c91c8182125e37e22ee8b6b9942f5f2a3e0a48f5af59ad5232f64c4424cbb34ec4772f3086b55ebcc2261e3e3019f5c82fc12b783328b2a19fc80eb3089c32e1e5017012653bd42ed78b8cbebc583c28efe8b9c093e0d3f73e72e6fbbabc24ef50b9042462c971d8d89645e15eb7e844edf4ed348647e29226f535ca03c9b57b3f493a3c5e00ad65cadc80b5dea13ca01346258090335937bf5a6f2c5dc44153a23511cf20f475f7c0205c4df69cc3cb28149766db56c8c6bfa30f9edd3ae0ef0b11b055cc4da28c297bf8cae2dca2e6a18f1b537d655bb83882ead1fbdee925cd1475e5f6382d8dcb7947bafb419136b1a0b86063c23e472aa0d098b5e0b2b36f736bdfc28b747ee1ba06a80dfd6e4812b4051f09588d1554c72df29bd903a67be5dbdc46a38bfd32d069a6859b7323cc1ac9bfc623e8c890351945bc8991819d160ad338b639e97ddf14cd0a9a2bbd7e6c22b80ccc9e832a9792d14e3d3cc00ca597e22d1f383f410f769a5562f9da5d9cf07b6127c821d3db25a1d33c8105240575862c2b332d4b558d74f16de9b94b9493ea5fcba67e8595ede6a7b2ca77c980e4184f5ea2e6dfb1e60c1b2eb8ded9d7bf5189c7612d2df6c075b8191c16eaa9aa5fa9045288cec9977d5fd9c0f83f65f46205fec82da8218a817c38df18ead9235d5508a4e3477fe9406be240259f5675c0c6bc5986403ec977aa7f3f1fdaedd73d84892062a1961819e45ba40389793889d727bb9cb4a3f2c43c07ff977b6e284ba8f9bba56e5aecaaab6877630551691c27534593c5bc979604ba9d03a4ef09a1d3cc1a62347bc9c82e2ea318009635307b94426f381b106f6434f73014fc094e7fc0f5ba5064d3aa86ac7b4c4c01717bfa605f8eb28762cb6080a28db33dc7e70bd2ba8a0bd3b6d0f68206597e47fe8ace074e7b03f650080617f0f3284528d5e8ec3d6a43c525437ae822a8cbfbb943198b9448e11a88e2dffb0d75987d2cbd2afea4d4f159a0f4cdbf877bca0c7ece8dbe649764089f0d17b7a1fa386b80b7b8aeb5ca057251cd9dcc103d66759cf6ea7402f0a6467adbef15da3196a67605815738056e99f80462056f2392e8ad7911e0e10fa41b91ce11b22f2447c0223a3c74a66e9f87279d3458c5db2ff2145bd215c798622d36c2bc0adc0c8c631d1dbb1081b2f7d2f017808e694ed90b1d83d43157f55401d9786476e33cb18973c47e723162aec204ac5f4abe76e9706ff0cf126e10ca876d760f5d442f4c4f71cb0e4a7b9d5ad76926ebf6cbff88cdc801b020ea1fde9732cf499d96f2cb795de67fa5df3ee25a84ead8bf284c4e3d0f7ba6c88a8fe8717a4c1f092fc8f4911b6b617949555474e8b206c8a445dd23e13ab970b7d9f18fdce51f70fde4a7cec4f8c09f368af086bd520405e838d4951090341923b9acddb2681eb83d63b654928a3ecb89f11ebf7b182ce718dde0e568e486f99ae86b6cd5700d4463ec3d4acbe43575729346dc2d9f4ccaec16a136b7c59b87e8daa84cac0307db81e675471bdb1666268e14133597e32be2eeda40a16f6166791fd256d398932452a186a6f5662df6c1758dd99e40a98a0d10f5cdfdb87e02c802ddb95a8761c2cb0b455db4b57ee37a560e07a21e2856af8f6409efd24095d834564e4262270df455345f607116e5768c8e3d22c99737eaaa7544d303f61913e706039e9131e7f2116d005c597a1926d0b2129bd820ebcb1621538780107aacc08eae3becbd425f41a99b324d253b5fe0e0c1d42d0f323ec2c907e1c9b2a2d4cf023b4c65cd21c37f3b2517e442989b4fb3c60131dac9e3b51c6e8e3f4ed22890e6cb0800e08df7196b8c43ceb3d6946c9ab20d1db9524a907ef0fe7d9ca6ca7c8204c6d45bffbc842c2623cc5a5b4cb56d7d8d67d5924b144e490e2774e3e2db6ba02db7e272d8e57ecc4c0a675385c9a3e9906d82621d5aa10f0bda1a00142d8b287fec90a7697dfcb112d5d32d00fdc0936837d855c7dbe8182dbbff6c41f74464f76932436647b43a119136edd144a053cda42ea95b5d42408f5aa3bca12f6a95094c9702cd053cc76df812bb56f1cb046e922fddab8022a50564aeb7a310dead87bd1ddf9c3607ba2fb17a012e847537458438d56f623ec4921d84642997b48e2743c9753215cae3012274d10e5f1d2ef9b8d3e17b0dea0ff790699e98110b83ae2888e0f7f68c43dc4e4bdcb3c2ac4508fcda15d328caa0949b2435a74658988042b1ce890efcb075c837272b0f435f60e9afc679383a406404e5c3082eecadfbeae5df13b70d3a6fa7befc16e06be2f7b1615eca414febe267035f3e80b82280231896674ac764f9d2bf6b117493416bc07e6b86eb43363e35fdd8c2ece69fb1b00161b434c7d6ccc3d0a89e9faf6dce4919ad76bfb8c1c5875b1dc6fb99fcd81690b7dec119420ec477fb7d74be304a444c177183121a44d3a284beceb639720722a1fe4f18a2c7684ab9ba96087f618483f40b5345d70b0837071db77dda1741ba125b4da552b9b78bc646a31a796e1a21b28a7b541f826b2233ea64872109b87962d907439532263cfd29b665d85425390a611e1d40c1d15c8bd2956d123ba0fbb492e0203152160cd607bee26e120665ccec0562ba980bfbad1bc14af906a03ec9694a5e5b7984231b2976eaa4c2ba6bb6fa88a8a136f9bd5b87c9bd3788e73b56a4a946dc5354983a022795876011c078eb3cf922f09fcfb829485fb2692cf0830542499225fe3a992ccf1a4c576c5479e4ea43ac14b88f4af8522c4df122f366ec39b91068a93b67ab2937b27ce4c4887c4fb48260d5ae5cf5335540f4505eb91a131a2d6b45d124f0b6c5d54146f36204301cab35bd7fa77f7b925c2e3bdfcb771780b7c414bb7f3081b22d6604082a515e4cce63c6907fc090462f3be63072ba28e96d89cab367870b53bb79b76f3a57584c27e43582507efea7572921c3f03de2a4ed3e298964c6980d8594ed3340a8fa976d6e6a33ca87c366d3cb7120b6a545c16746f98ec6d517d65d1e7c3005e2703598a119ff1da329d78c96c3d6ebaae97cd401f5bd0711c3061f918a949b351280d8c6cf4a7efac0d9bf44bf6287db3bf93c0f29c3fb0bf5bf7630e26cc1abac4220b5e1a0c33de33903c001be18a74b442617e4f62b06996b6ba5d488d50e027027902acef32144a4964a54688400c246db17cc3323940191705a628bf6e60c7a28b4ef3ffa10775704d0ad66ff0325b57d386fae22ce73e6efe71238e20e8503d772331e51085e063db919199a08abdd2e56616a18f05dc80edcdebf5cfffa3f5ab4a667a31d4b52a99ef931579932911557cb06e551b634e4abbd15c3056204b4ebfe19787322241daeca8c92a74029916ded66a7924c87d3e6472aa9d6041efe74f1fbc991e41188c42b1b5d7bee137d027b9fcb1a97f4a8e164d7b86f4eccb3c941ca16366a01db6cdec3b48e39c237822adc1c9dd3d5e0bf070d94519c68d5041356af9b08d2911e21154c21fd7639882311e1a6bacd57e0699975770858436f4e98b1581fb69c15f199d188783d6355d90416f447e268423bd9c92e01649f44b68b2b14a7113d118b780289883b2ed52e20ea8cec6dc6c6425dc6d67ec229439e8a46520b8e20dc5d19b1d391ca6899c0caabbad5e708adef96f5a5133d7f6a5e53b9a72ab406e384ef7b68012588b781a6aebebc1f8b366ac7c25b97f1d7b36099b1b7369582abd7830efcc457afb0f4b1cddf6328170f594ddb581731d23ade189f07ec4d0e2a084c8bd19f618b7a9cd357377cba3995f00638859e8dbc6611fc222a9b5bc794f70bceb0a819785302e46cb1c550dcc7020785e1053749af352bfbf82df3e23702c0b625a02d10405675a9deb983dc9745addb19c0e0ea23223d2a6712204d6faded68440829461686638cb2ba97554145d3dcb8341b986746288a61288658d9b21b5ecae4219f9f95bfc9384ebeca62bf2c8ef0ad34bb9df5d28527a1466983c58859697881ac1055d71b97f6c43de408c4fd0d25198a11895039bf756b02499a1f6ce3875ce0481e5ecd6bd0e5b302b7c80bf3226632213faa201240b36b84c5e0a82d31666d7f7ca163d7207bb25e7dce0669bd08599d2442d47eec9834f0086a897c7c628a50de889255938e2ba90cfa8569801f773cb737faa0757e4dc34994ed120720f9badd5c83e56c6d8533146eacb268d1e94b4bace11e9fd18c057b71dbde2b48bb353b7d3aecedd31552d5ab5e9d04b85ecd50b5157210a4426688095b7f7b6703d74af737a1a779c5e575fc3caa807000893ec90678b01d0430421d61c3b8d2b9a6b6a85aadfa44a0844a02171c2419fcb18fea5aae8dd95dc2d4865f1c2c8c8794992052dda0b8dc455b0dddf97e7be103f8415a67410e917c4d3980abf65d2064d8a47947a69748915d22b610654c17bbc9747a31835c46c35329fc2a7a7f73ab71b2d0a6442ae67f851694ede118ddb438c7cf25f3cd00a05453c813fca63791ce7afc978013ca80263c56c0c080d1d7bd899c9dfb3a6228542e4bf82970e57494f3bf4c46f0d3117f6a016be47c58fee2c5d31d5add3132350f1ed29a64d0251114a9c9ebd033b9c2cffceaecf7bdfc293729b97413904a1a5efbb2c5223a212d1a559f72ecd1f5699b2d752c76bd64c0e3d73337d284998eebedc5183c7b2a7c6493e524238d445cf5715d8a55b6b3834c512d3ce6f1e4a035b17282f0631e5ce1e9e6b2f0013c8b70a1ac65a52319fa046843eeabc9e7257032d6eef6de331a9004378e8c7efb1e62a4152f3794c5727835900892fb5918a902312115200af548231152a0c6596bb878f67043ea88e46d3e017b8e9c9fd17df90b0ab945b64414727450f6ee6f5a22b4cf54f85d3bc5af4f52356d72f8bb0a49b60fb67764383ffd1b665bdbf4e24a5759cdb95819f76c3793c56e58acd66ad143e1bf43e239bb9828ce20b4a1e801be5ed004d658dd9088d6b6549f94624dec472e9213d220c79656b1546382c46094d06718f5aa49208e58e7bbcdb5de12a7d4ced156ab45afaa94a0c703e4cfff49e8dd6d7e6a10e71154874a568028f70a388363d05fefa580449efcf39e33a6883549ad675e2a5331a5b74cf209ba384b8db8cb4f5490ebeea129c796934b0c11a87442118303da0d6d6272754686f0c3b4717649f441c39f47f2e41235cce93964a19091749cd817728a704e72baef5444623c5c6f92726c8139740993ed5791681d7eab9e4ae84daa3da809cefb403b17ea21ec0cde817c9f901ef902c48ad77d2402a906ae0032cca75793d1fde51554f3552f15311ca8f9e03a876a34c62a55f448fba582a9781ef5746f7a0d84208861f1a2cbef5b37f7764275e187cfa171ab6b5c757ac3f91b9f0113d5ceae874ced0bc048e84be1295a298d64e95cb9eb3318521cb36f6a74973b73985b500f9ebb5e4736639ee1b38365dc52541925f3508e91710aea585c44bc9736c2646171ae0ff2ff4cc9bf95f229b15f52ef559dd1c0187bc79ab383d7558e6191682249fb694b159b26a42b52080737d7d10ecc2026bf3c95c716e73667af7586fc0e929a122cab9cfd14cab7e58950fad62148ce9dbb0b4dcfaebb10635e8813569c430fd8d0366f489fa7a16f149b1628f51e60c9f32294b0e9c3f1b35b17f72ec49ad952817682db12b91b731131ba6dce6ac9a78a4df26fa681e4b9cac5660cb2ae93143e1bafb9483eb58d34e9029cbb196e4c63e78e368a9a903a5320217368930f4351fc9ad64fe93294ea6fba2e13806d3b68a4ca4531338c6a4f67d0eb1f5d5ae142ab2540d5ec693be12561b01c1f8ae77870982232800868f32e97ea087685f465c7fc7d1597d2165cbebf7c149a5898809ad104943e14f32eb4929edd996aa8e33dc189c66ce109a9c97cbeed0cd8e9cc5076c7df50da6f53ec91fe5142593ebbf7994bfcdb41ae4916da3db0789341d55118b9ad6f3b60ce489bb596d5d12be9a858e1d8873bb9d090feb28b05c8864fa467c40cab9fd3036512cf8e56f6608b6c0503366a8c4f1ad72c8877d838cf0fb4b95f777b4b6ac3356429925b33b45636b99c25fb82dee404","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"666125d2285f1dab0f009ee7052c866f"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
