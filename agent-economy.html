<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"fe898330310c658f07b36e09de0bff867e1e962bb3794228f3d53a24d4cf173ab05fe9d996ec0f3f3b8ee5c51f6d3e07703338e8546db5108e2269bed88b778f48452ccd64bc42aa669de4bbe82b02148d52b112f6abf4076e032f067bb0176b7b25373fd555c345befb8a3c2132dd3f5236cefb1b50515a196813d4b4b1859ec4dd4d007dff700ac862162dd1de526eb036bdfbe054b4307b4d926bdb2feb4efbeec9d4113c0fa4fc1019b20f9f8266092e648e5600ef324a75fb3da6bf343544ee44534c8e5b175f7d6ab40bedb1a213d8bdf7a16bbb69d4fca299caf08bb76581219911c58082f8fd2d82ecf37a417965eac1bb19b2d9a309ff6585c59c134b60b0772af7c6983852aee0894d37429c8696ebb5815aabeed3e35ca1be8eb143b46565cc65b1d103156db1c58d4748ece6af39b6eeee7ae8d3245a19243b11e1bc29296519a1378b03b128361cfdd0a9ed59ebd13d60f6e368c46916cf0f5845f6ac2f0be8d32408028b2a3aef38c72916978cd083da6bc86264d1c744fd394c19c6a2fc1b6d5ad1c33618c94990af6c4881f11df0e74a42df5eb0bd97fe8b8d6479b70cbd679d85fde2c66e6b61507f44a6217b14d89600d66d9a7f60a4adac63ce1139b31cb99a3d958343111aeb37651d697dacfc116e1d621b1aa40ee01ba43c22b59b3a563a27849b8baa3bb6cdb9d6039ba80f0fcc8ee6e097cb046fa3a58a920ee7f14705f265d029488f2d8677dd681afd6a54b9d9474dcdd32cde05ad6657d64292a14137de82eba7831cefdd1e05c387dca9555b91567631e349da0027d854fdf30b0370d82de130afe7104f6b1bff18cede6d0d83c31e14d91adbe2d51fd06992eaffe9dffe26769927dcc0ce6bb8bf82b74030bab76a2218423441be9eb51bbe7f38df83fafa62737ce324051af049bdf7ad5874499ef5263593c80bd87992897b32d4cdd0c789ed1e1e81c10056746c242f4ab4674a6ae21d837e895414549451e08552ce180455c03213b11ebfd66d30cdd4a34c2327e3dcb83088e09b5f502dcdce3cf1af4d6e1cb94bb83f55d02d0fb6cb193f3f5e21ea5a30e3feaaf1f8c9192c615488f1cb174522dd5f6b72532e0cd6e125934944fc24c1d6ba6a058aa1cb71f54d74edd88aa3a6acbcb9dc0b73268a6cd484b56552e3cf723698480d9b8b6303b3f6f6f31dd69d9ee6c5f6f39330573ff5f128fe68b3ab4777882bd6234a68734913d548ca5f28283072ee127ecad10f3510d70d5a87c6c18560432850fec0c0e339d9ef7618c95ab92af6fd8fc02cccb35c029a89b831407c96ba96a8faed74716f24c2ed66b15fb7d8f7fa4317b487c1600b755da00debff44b8473b2d8c724657bd66d096cc43b6000712601c69877d637c9d1d3d38de26051ac3e95ad7231ce5a6d5aff4e9ea5b3bbca33085bcc7f6233b5ba09b654fb76a8eea281c3bfcb0a2c6d39229f35e06ce1e1bc86d96cdc8ae9fc174fd505c0e89d318f276cc0bd7f67e8a80faf98ac8f6d2b4efacf40afcfa83e168efb776f8aefd3a7c0f02b65887135d91b3355691705be6ba4ac4a63689889819fe56cc98bc58ac430b4fc6e6592c59b76416851f62e73d1f42e442040859dc041717fa5685c8b621c138f8edfc3e564a832b210328cff362e45b5247d0b856f316220995ffa373b08c0de7cc59ac6be92082ab7808b72f59dc899f85c07e0552f7b158b8bcc47798c6d7e57249684cc5cd8f9f94fae3e040beb7a2b9d1e8c958f376392daec9c8ed580a4ee6fe3e7a08d836d3b2ed92f15ca986ef6c8faabdf8a526614bdcb998344d0854e1aa64866cb07ccc6da3de9e3fba7ef26dfb248d6447147073b77b334ce0cc5ddfd329a6a3e4ec26ee1565ebe5e944989d0b5f8b6cefff16503532610851803de49416e41bca87b7b3593c6563834962f63e2ef3a323d36498964471c7ea77d281a177e600c6687e0cf5d87aed40ad6ad361c6e55de9eb16406a2c2e4c3abca3b014b79ff906b262a10a812e5f424c0e13ce7fd67053a7ecb45ab4b0be1fc6615b594b7aec89ded203792c82360b9fef76f759e2135c1099ac82048fc54fb234cbd48b43909db61917da24802b0edae1ac58afc0f390b1641ec6e3e7391ea011263bbc0dbe24c4c465addbff2d30634de5d1c54ba585204f454d8be2b2134eab97ae7c776ca3388fca694429c690128c168fc49161df112dcc19e6acf6b03cc66e910c1129d3d031f3c7051e8dedbc85f30671b7b677f2a3a7f58bebb95d22466322f1d0e2444334d0280845a379dc24c7983f81bed46361680d60ae777633840e8e0e4c77ff04a9f30a8b501652d5d1a420ecf9069de65fe4bdc619121111628b1e303df437672464d32a0b222251d7bf3d5bd90910037377fd9d3a6cbf7aea65165d06a06420fd4c92ca3af560332f02ab924e142e9d7faa69137d156c036e27fd40380cfe8f60a2f74d89b96f1107ce62f846d5f7e91a093c75bf18145c0751a9d15745745751527222b01df5fcf648b399414d551fb4a2e2fdb3ba9ebf1dfd23737f9afe1421649e101e730e61b3b212c45c147b52c3faeaf1b8ebe8e5c0041115fb4576b550d74f1558b56d73bed0fa959cc2433d2f424446007983a3b443d60bb3c3f7cc683c8e56f2106f983bc2f5c24f809dd2348118c5183d061291d223781a51f3b6164d607f4c6f8c10d9aec54c6a9f5ad0c7b61d99e8a88a0748473d08f01238d305d9e3edf8c2b3c2af10197237196cfe322a60e82c33e05ce6aa6c50edf8c7159d283c3f7f9f5b383c0087b13d04e1b21ae5fc18c3c297414464b6af0748c93bd54bb59c8cbb876c9eeca3e7cd5b07086b1e9f0c75b2b3e77349956166d4498cd7c5b1eb8d9f44bf6a5bccc2e4812247e4bae65c377aed129796d90b693b750a233a6b358e088ecd726a5e5077380cf489a097325f7f2c95f590d4d1b518368292d6877106db54218891a669f24d9d8d22639e2325a9823002b5c4858ca2ad81ab17379a372d8a91b94ba7151b3f7269347972c4f134d0e2cdfdf6688bec8891122e6c8cd4db5366ef9aa23ce3b7eda33aed1d5a381089789b13e932e5388787f9f074891ea183b6c192f65920ddb533852e94a7a9f0dba88c401f54e9a94483b69296c488d244c4e8685b803fef76f975b8f13567becbfe11978a4094861270fb978502819fb21eb06ef531867ab2938aaabeb526b364710551f25919bd37d1ba9330ccace122b0b83cb28df0c02503966f5b67b888eafab786971874bf1519312f41bc59cccbb2deb784759e7e3e7dc3e76dfe70c1a2c9877abdd6543c174a045884b0f44be2da1574f1c1bbc8b5c6dc9c5a05d890eb2712c6cf8f8c128828d8fca4bcc8e47af7817a84c76655b21995c2cda6d40efdab8d3a16acad2792965e0581a2793a59a35c618b79eaa4c88c6e6d193e5e956e06c992d6d53526554fd8af24d833af91e5a51b1643093ab2528abcd0d08016ab2665ec80026b6cca76a46fdd17123920ed6e1d155ec33bbcef62dfa3e2c19f2231ee19a3140fa3f5eb5cf76edeee1e9f9a8f121adf44c0768d44cc1a43a48e500cb0852ffed150b625c402cc84e02b86493b8f1465e208aff12c04da00d349da35e75d66ff22230d344155bb6fa2ee000a0f253f0d1f798dc4805853674bf828bbca0258ad260c2b343a372ccbb852b6188687125ffd50014524f795bb8bd1783095eac8cf2a066b5ac31ef2fd9c53d6c177be1533e31a9329f8e2e7d9ff2b95405adecc0a652fb48ae0aefbdfa7763f18e0a8414db65e1024c70a5b7771701ce66aa2c5783f3ef6e5c42b94612c67b9d417843de2d9882c2eedb70f2da97fed2bf46fdb507c63af34804a63742fe3271b9aa80ac8368af9a55dc8c53110efc774d45e296f5a4cd18ca45b8a6d2bcc4c4bc7cb0b4a2520482542029fe83a6ac09e92bd60ddfe38d4a960bc7305c39ae542d13f69dabcb0b17f2501f97c8b3906824b4334d26f131bd8ea670a213d3ff00994aa5ba30915b23a26ffb64a711f85c02afa426fe653874bd3461c86af25e34901207ed6aae23cf0e1f2164fa9ab8c401cf42710be7a1a88a2be28f79b21be112f47d99e74f84ecdfea8bd464d3a84849a5e7c8dc04ba51c1504ebb36d75c387939677274127bb09da1832f07b7e3436954404e59c26968a97eb20be0d40958788705fa85554ad113b49d0552bfe90194669e0f32859101c7d56728af289ee0f66cf8bfe821409ae241e4db88b237fd484246771e427d0cc2adf1dad0224a8c2e96964eb2d96a00531758caacfd2a723c691752146ee594e126efca6dfcfd3baa5338934095dcccccd2a74730b594d3dad55265f2680f071cff41f1cd6f0016ad97a671f386e5e9fd930e20f26a13fefa72d7742abdb3ab2b25649d1d32b2d618605ca69e717e0216d8f35bbcd439393ef7068644464980fe7ef5e4b430f268c7e438fa80535e7af633648b92d41044b5462ced0d9cacbc60feab0ec88b257c47fa0204950df78db628179683e2168598ac6e22c0d95811a0aabe0e51272e2ce102aef21dfe740fc6a8177b66337a674eb34553fcb23d55b553c31b818a126e0e19f14efaea763adc904ae131fa362f7c9d409241b5762eb71289ea49e56d11c6f04bf5d4fe9531a3a96405fdd1bd252967962c7d5cce2153e8c6b88807316f6a5e87ad64d42cdb125c3b581cec093aaa79dce81c1bbb9256340cb3ae99f00096889739f5cf948ab07208d83d94feb33e79529f2c6240ba17eb9dde52350cf6daf7aaf5d83c960873b2c4025c3f29af3db20365e3885630e413cb8b92dfe007f460a650bff651d851b900784a852ed02f6f05019b69f850f5b54e1d71e90a6a293ad56c4252c8a675f767f3df0bda67a0b6a9c0754d77a136bede2699a706e8c9c4e949beb4eee4e9491a194f285bf4d605cc95c4af95dbe0cf081ff512dc3075d51d0e581389e8e1f4b353811dc55906d9b353de6bde72e7356e44faa989764c5a77b5ce6b3e35d56ccb10d08e8b0af56cc10c69248ff811814683fabe6fe8a3a166494a99c879b0a36d7fbbf0e9f789c72faa031925d5747b23457c63db5b0136704120fee98a1d43bd097d1d257e251596cde85accaf6d75ba2aefa239048ae03729ef87655ec1ad90e921f2bebe31c5837e7e22d5ba1446e46ceaed0a150391c5fc23d5e38d604d1cdc2ba68caf7bc3c9c009393eff8d84b12770fdefd3c5c6cd1a2c84b02d9aca364f222f03a78cd265feaea784215592d62a937e53089a4ffecd06ea1a9779357b11aa508e83e28a8cdc4132a86b897433fac7321875ebcda8dc9d32ab1e34836caaca7d4bf6b00d20b0dbf14c31fc7a479f265d476a06168326485acd9bb124782cd18b73ec399fa949f8c738f97372a09083ba591e8417c9ff0362b899f801214d824a7abe4abe7494e92728a9058cd0adea8a0ff15b1d4fb13c8b51522aa20100385eeac17039b463e1820c881f8d9a58824f61209654890b2bcac8f3a9a7a10a56aa25512dbb0bb14ebfee13924b0a5a224028e95719b09d9a2ecc70403f4e8ebc1489521ea0456422d4ac9d758d430bd909dfb173e9b72bbc74092b21e3cb4df2a0de75d3db63b03fa11037792f7bc169786d6c1588752610b8848433901966048b6e54411f00394ceccdb263bbb523cdf76adb31972915b04a0e708204c9babb5b31d889562d28003e140d65ad196f9b89bfea53052ae5eeb93e7a9fa07a9559014f123cf24c22692d6d0c8830b73d797421a76f28244ceb96762b89948f7ba50d8a3e4688b4a321ef77eac3bfa1e8e0907969e8b424301b86b3d8a08bf3fdd0c26aec0ccdc6772eaeebc428bbdbf236099953b211f6e244657fa9daf0137aad9e218d4f15d2e97e86f406e70911f35cf96583f80bc6cf27ed80c87edc5a10a9709e0597cc537ed3de9710680a50b58085f7d9ab3ade355e5e4265b07198b56a0e242fa0c2fd6f16cc8f122cccb98a843bf12be0a8cd13e94acd591901dc544c06f87fa079b9a4a44fed52ed4cf0a05fff22a00da582f3aec95e9b7968a124a118bda521bfc1329df2218c849fc15e53d8c71a1a7035487ed77feff6c72839960ada65e601b2bcd5ed88094e4306d1fc308b301852ff3a05980510744dede5cf96411880100545ac926892bc553791718932e8e24f2904cc4cfe483c3faffc05285554f0b6d4b4f17d3038d1b7c64600b32cbef0e6bfe45b9878a8f7ee2ae47a51a521403555ee97e5140be5733485c486b27d7a627b9c8ad9815bfc2e3eb5cbe6a3d94cb80c2250e59685023b6518c3362345abb4f11b8dec93ca0d1670896cc6596fff76fbb0abd2bb30477ce0f740c97457fd80f923c5258db46e5d33678cd17e3ac76987cff5469e30d6b80b1e443b567ecd0d929a34ab84c3632a2b36dc30399c3776142571730e9894c9783b7fbf25b273e30dafde15df591426239f3b48864b22e30f482d75c4b1c2a6208b23083d16290a2a490dc820e596f234b7e1d643561021bd2c8b8f2412dc2096a2baf4bbb5320766c5d04cfb3d781263b83dd5b0074a10449aff7f062f97cc9c74e89587d464d70b0d2ad234cdb72629b2e313fbcb67d00ac84ab884fb3d0e12fe9f3cdc010b28682f1ee7cde12be235d4024bc656bc673e98c9fab5e585e6d731e2fca96c2500cac16a893ad23aad755e6aceaed8f5eb5cb2b81d6286ca4675f09fdfb2c68d6e56c04b72ba7311d957a6acfb1f6a4350a80a36941d7d505e4e48860a86a36787235f5cb0b9d51888aea92302ca9815bec8b94de01591c84ef25d288f385afb05414dba3ded15c8c5154057252e0b26b12f63ebc2b993a7a0ffa09efc287f2d75d2f071e8a173c7db596873451f6264d778e9d1c6644ecc69b602e89e953c597f3f3669ea37a5654331aedb2f272fa66f899a27c364989e1c052b7045c9972acee7321bb881b27a414a5e4568ae6c55a547634e99b2fe95fa1cadfc6d1775d65890bf920596531d3810a76a23b4031c5de55426cd9d9730b82d03a4acf2445f00c7e55b750fc716b1b81902766210a59704cd0dd8369f0837b42a3ca2b765d9ae78d0be450149505eb96e25ce64d7fd886f4088f82a117e8d0f74e6b30b5ba4580c3fb123bc8132b7c9787b9e9577041ed95a4b84ea6c39bb8109cce1a2cca13c451a5ca4e97d77a55665d0ed0b1aaac3f382f2c87bfd7f6492b8c6a85b7af6941ae535ff165e5ae86936e7e1ce5b3638c7c88e453b46814c89517e48a991f3603ac0e7b799d19575eeba3d92c1b38f07fc7ad2c4766a90af7ab42b243375c165da5a4bc8cd3bded64ea14fd50c5fe652080505dd512801fae71c57b7cd7306a7ffb4ee3bb615072cf99478359345e57aff5025e0b4042cde940d21e5c5e45d4334af1439c33b01735e427b9d41791c40b643d6c884ead7717a374407e7e5cde3306f608f0b23546dca8917de2d4eafd16a76e403f3859f03006b8280c565b08c7c982f193dc277d343fea4872e4b9d56c8683f8f2a12949440d55bd7815097bd3f20eff539fe226465282128479c6608d6c684289254914a07022165479b525e53f6999df3e7b17c9dab35d5000d20df7621e2517dcac9cb56492ac8f99f56fe78955306c42086b8c3359e4a1100fed04be18f5b397ce2066472cd6a045a511c0fd66f73c3588c64960115181c10c36e9b22edd1cca08a92988da70fbcb5ee9e85da90d57a772b27ad4a7d8e7f565d2bba3eb2022722a2e3c965253d3b8a7ddb369763488a785d4e0488a2d087236e93886da5db76c260edcfad626d597a462aa27fc979d1caabd78cf5d4f42539e48f85d978ae2cd5f9e32ad898bf3aac9ea6111836d0d6f8df53256ff8713e64120adf9327ee60072b449e2a6105e1f02013caa581a95e1b318d9568017f76cfaaa352d54e0312c091d3b0b5ca5d957211c98c02b70283f449ccb6585fa35731b6797ac29b2371873af6726799883c621b52299aed3c93d2d871248ebef611514deb9282434e491f77b729d04f7c1fb92444fc0bdf0a9c82c3c76eafea739c9e2d15732179e5a1ece67b0556845a1501823e34171f11890ee501652f2727470453f6eb3aa1b172b8e063520160d9e53941cfc84c7a01b2572e4183902f4292f1cc7a0ac6ee7c94802505e00228c23c61e46af76e37446eec2894e1686d9b3e59bbcb224b471aed562e2517726d61c068c939028c945ae82d3bd1834bffabc1faf51827679146bedb4c5d5ce32bdf14567271bda74f532ddad47b19b7902b669662f0b4ebba7f34babe98701ced67bd48208b4ecc96830bd335fbe54d6bea4c52a5d3967976979d44f35ca2e93ef6825f71f2b2bf4a919bc1698471dcb60a55a187d1d8e2f7276b64748b3c55f9afbafa0e9ddecb0742964d21b4123e196f8eaeb044e45d7f30d4c4a9a2ca1949bf00502415792265b2a6a9f1ee27b34866f0eb1716a2ecd09622b49217086d8c05e53cac10df0249b27007b62324c834789c34d56d8365fe95d91481458b6a3dc0019d4fe993ef87c760648756853b53d221d2c41aa3a0f5c2fe08a953cbd776b965a427ddc5f259d0039fc44703a22b652dbb1af7eeb6fa184f60df59bb65b236d6b53017f9d2545e2c90d3f92d9b6b0a2bf5a5ce0531ac773f23580d44e8d8ab0cc7f66ee8282ccec60ef4381d32889111d75f6c4e14b5eca9ec6b75cf3ca1d030baaeb0625825f215346b6953fc5c05746203dab0750768d4fe9b9e7884bb509b311444a4866bd75fee7bfbc5ce6994a82a4ab32abc77a29679d2ea2b4e5ed4d971b641a3b5ca547510d0826d126cb94ea1276a0269fb2dea7e17d02193c45696b7320d5be20da07b156691e95d63704ef4495f99ddd2f0b2ab65862583b1bdd97ea114d19fa188e842bf233c78d6feabb2efdd8e52b98edc4655487625a02d054599c4bf2a9107da5080ad4b1ae518289ddeaff28a7115895ff8b5fabcc9af41180e4de86373d2c7e014bda03df5a02189953f23c96a35b37614e22e966cb71db532c69292b5040942eabddd20935ba70ff6ff28121e9a75372523e6349440edcc4a3d103dc0a72c4946c01a3fa856a6c20e02b8d8fda2f817b54806f2846b85afc39335250c3d4fb29795bde3c0240b9fc05b83a19898fc096f7206554052549c266810bbf53dccc38d43a9e2dd8ffd033332997aaf89d4e69b91f793bf89608712f894a9add4040bba69f691b2b8ec7810340455b577879b3e62257ca13d8d1c84814207ac541b6680b373d2ad114aa9140ab7eb68a1c4b701c1e33d35618b64bbbb044b4e084c5c6cd6b9f0999249a9f7bf26bf17fe561748fc923a3fbe95da795d65802e9a331e4e87845fb0e6b9f168e965810a30f9abed3d1248ff008cd17fce0b8415a1324f49dbc55d3d6361b0a7d22eddce9837f1a1f222656fac8968eb70c31fc3c015082a45740b48fcbc5cb24b6a92900234971b6e843f44d46d0878063e310b1484fc5d06bd1b7af169e10e1c918273da830f1ab714fe34789b6e85ea3df686eeed1c341ca5e6172786c7503d3a67a213b02f79585d8c93f6220ef4637f11b72af8f4058c0aaa3435933c12b77a0f45208eb1d6899820e26374bcbae2d3f40500fb2d3669d3bd375af220db33caf2f5a3fb99758f64fc085b1baedf07a4d1e54114fdc050b38f0720b1f343402174690a34d95da7db8dbcdbda8dd03169e46df50f7e94cef9119e2bf14dfa2d236cfcfabd876b9c701256cac3d79eb238399970a64ffe9607d3e13514f1bfb8f755a8ac3d1b52042e7fa886cd1b1b04d0bc815b066244b2b9072cfc1300e8775ccdb78bbed4576cfbc8e6e9cd3642da8c90c18007eaaada0b7a74118143e72320f3b039d968339fee95c64b8639d24cde4b3b31800d7b7d9b043ce6375c74cc03178d7f3928c7a124f6dd06482929adb6879438b28744a9b4762af2da2231ded832eeab89de51371b75b7c86610d39495e0b72929f3b96060a0bb7f2dc00649dde9333a77006e246604a0c631278b739786e8548ba574fea8c7b3cdd48d09d1bba3dbc5abd3847ccebe41f76cc7720b75052564a3d74fb274685787e4581760290937a85235df67897daf5e1bd594b456961383338e0615344732c66ebb1a1665264ecb11800f5aeae7feb659d84fd03865861aa3a0b4f00c23547f161a11844149653022548e3ad79e9a4d6d447d7b5b53290eea7b9cb291295ba09df7f0b9bb417a627216ebac6dd5e085d9d452ea97ad5bf5755ede34f0158b058019747410b0f0fc3638e4e0874de0776ce59194174c90a0cc3dceb1db151f2a4457bf2eaeab6e56684e25c031f8f41051b359aa66aaad8fb4bc1aa5fd19f3a581c7e6b65d888ffd9bfaddb4153d6c001e7b62e731e6b57c87d36c1a4b854b50620795c834e35d7d647ead2537e784e11b5c8db6d62917fd6f20b4805f678429d3d0a6e611a000d61c363c2663807911003b05154e0a93811c245d993ab5ee9e40910629c611192697d6f3752e6e66114c6513cf205519073a568c0ddafe78f8882b205590e19089c5b115c56e637184cc7f8334ec2a6a7624109dc729ecfb8325e0db4a65de69bee6b7f31b451de3b6216e194775fa825aa61dda909daaf5b0f07ad737167d5f256159eabe3c8375ba3f745096e5ed58c95790c4b3e76475c3959a47ef6ffe90d7a2a1244d50645a34a603b1e96f7b28f87914868db9e35a91535d13d428077898f219f05caa15c1ddc2468c2c00388b1d60a951e7db0cc41354ec020f904732c69cbaa102decb6cf07f93bd993766bca2ac210d8ceb68e0f79320e51e92e5b6e75fc215c59fa78ede5b3dd509c202bdea4cb5b3f7a5f4dd5db2cb6176aff69fc8dd6d7b528d25b73b44b6445af0fa03c0f0d43541f962b4ab7a2844a03aba5b643677a5cefef8ecb56a8250b2ca787606425ad503d55bccecfc0ad8f07bbb4536daa4a48c41d72b45a63f73daa59ccca9024b29497893e83e1a7f4ee628ff2657f235b2aa641dc9c752f393098fb71f981d6c238ae595ff6fbe310f659505428cf5d54381a6a3b0a96fba84c0c58ada3468092a0c61a637fa13b8f3013dc611ffeb12179b839de49c9b3210b8f01f5f33080440f49a4724f76dde4e9039dad2e69f3fc1d654fb323ce58c31e5864a0477c9524a83323adfee590580f0b5f26e244f6e6678af130ec2a9aa25a5799e2f16f11be69a0136292162ca62acc1aa9d7d1c02725822d707fd32b248b5ed50d84772aba31a5ece4a5e91cce58043909af37d2e1dd927912032127e8fab328401ac8138f24bd8afb0eda05e2f4c2f0d06f41ad4f24bbae504b48c6eec1e91390b7ff341fbeea0d97f9672ae872eb0f719bc3c1d06537ba3c3fefdbbb5a6cb317ffbb74a791208f6d564cfc5a5bf13ac34e20d582105f0c201e3e4255104df68ee7f67e1a0feebe7690ec00db67b25b0fba37fc5775cbc2fd05efb3a697d81cfbc7e6a11325d04afa176fae1538cfea1b452baaf8da80725e2ed67ff19226ef613a85ce08a2ce55201dbdddf5606a3b2883757ad1cbe578e92ec68863ed5d6ab56b08fed533b7fbc16d91c8b4b3c783370bb64cd28a97d1ca2621f1c83d44e077128269275fffbe0d53af462b5e66ae711008d8ce9dd25f103f4faed7b24a49249bdb7f7f7170eaec0bd1626ccdcef14561398b35e841bebc86847afecec834de0ff159637e163a5f8efdaec71c00fdbc194367c9cec6da3e57478f6076b0170efbc7562fc923582be609489e8d057de068fcc48703d0dc2c0bbc3e01798fbeaf16404f78cb80bea1b3b046526cb6be04705a61317bb8cc6b294142391a936394f1e8a572aedc3ff353cc61131b692ebc736f1829b65d6f5378b00d17b177b8417b0a4cb94ff4ccf015070708706275e734748686333efc505745d66fbf8df252aceae3ad79848e6a01c0e0270b441f21fc6ef75f64ee84e91c6675d50f9867b9a7579a1f0360f36a16ed673d5f59531359db5fa197eba966c1935772e02c65721f66ddcb776980b27ae7cd5f26d9fd6c080ff47a0e22a322f11d15ff6c0a2c2f855aa3d78bcff2052da9245a528eec7079707d832a67eb2f888a4e1145c1442a29b8257b0a175a458baa6c1ca5f599162d9b02cd0985e0d836c77769aac48ed2c0993d673bb643005a60f89f3284190b4d409b6c3236c86b8526fdb0077832b3958aad8e82a21a66f162fd526c8912b47e016629c09c0fd65327c83bdf69c1b22a61c1510bbe8e5f10c7a2a8c4a65665e75e1c46adb29c29389a24d02dd34e0c454bc9590e0a4f1005bc44bd983b4127df37678165f93a8ca883b2a509e052593158f41b41e42ee6d23b8c42c0191dda8cce2b96cafd910851ead3634d27567fd9759183bfc788bb82dfd7c039de49d6f23b48beaffa1779f2efc986c7f6160cd3dc45e4ea8c4a94347645abc60fdb61de91d602e276d30e850a3ba5c494ca5894c6c7dfb40153ab87298d0798859bad8d8180ee489f4f030b312f99a816367b47784ed9c9d8cd3bd50172f4fabbb305547b1ab8794b4d039e032186964239d876b27ff069e19fa8eed8ca41cbe310a1cb22dce5fcb34f7f9496518d170c17e53e88069bd1b1ed52e808f31dd2d3dad2cbff1d527c14683ab44aafff164cc382a9916387e325aeb0c1c27a728a98feab6cd64ed9f17287e96ce3b881a94889c6e1a582a96fdb6010f885221985fecfe1d20b773a3083f01da239d9ef2b4d1a358b521bc9c6939942fb62569dca12703e9976b71634e96093459cc93ab772971d6e2676fdf55cdef8b76642f662553f33704a5290a02cfd6905a3f1479415688746e26cb77be11fac7041d4ace066de17317294a39c3ffa67b26d579fdb9853c8396a77d1980456d10eac7453df20db2412e2287bf37975cd6cf3baf52a8eee860b4b66f73cec83ab6e5ae0552adc1281f66473eeb829ef3309d70c0182a33dbd6a7a1a86a05c75d776548290a9cce4dc8f6f6c4a181600f4ceb812eda5fcef8226afd670e77b8fe95d1a2c140e3e731226a572cbb181976d0ee3fb1e73adaafc7b282a4d81c8f275fa10afca6c2102d4d3b79892334026d70f2af1a207944808b876d4a9423e3de4e620987839a55474e90ed9c1981a8b00cb752d6c6fe6f9ca6139958e02a214d5df76c15d064fb3cf4afb0e1da0cbec8f52ae377786f16a0a1e2a1301cd2cd34e9706749f901727dbf12a23149b477e836f6fec98da1496b2f12865da706973bd05ee252d0ac0e3ca391cae0c6226251443e5dbfaa21654952846b74d538a4048412f7097908931dacd3062d5c659c276431f185095c72f163f33b2e5dffcd5c053461f04a5da97db306c4049c3f6636aaaabcc3f60cd2762089500784bf9cdef573379ba61cfd0f40ec7cb4e296019c8142374729f6dc97dc812f3be17bd9b7b4bc1151d723c43f00d293444344fc52b592b8771ad6388830df63b29f1255901e751419b21cb13aab75fd79acc9ad878af32fba3adac3a4fabbef4aded81a4f7899594d3cb34dc5ef5ae70eb7657ceba827b85fa215e60c87989886150ad167a09d160f74765baf19170f6a816f65aac046f91a769c5fbd8a00ba6f337885a6901a945031df11520f58c5ddb64ff21f820114bf5300869169fca5197ed3e6b68f712f81d4c654cc48af63dfc24b4edfb369562023edbdb41253d84ca7b190f5923b71e7c8de9179909a2d6a57f470676c957a0cef12b00ee7f6831f68bbd3961515dad02599f2b6431af1e02a8e78a5ad36be7e734bac583c2b74ac1f3e8269a98101897e0f3e61e4a2a52856ae664f19dbc3cd736808914436ebaeb0d3c6681ca833973dd2501005db11cd6920ebde25dbeb08b078c97aa6021f2eca8adb46b0ebe691b8c61c833aee24bda9a15d1f2a90b0d320d020cdccc274b6c3497675a5718aff7ee4ae1a5e88b763bb496c376aaaf8bbfca1e580ef0f95ed9b87516122e1f754424d6777cf29a6c0120011ef89266272f5a5d89d43756ce2e0a097061ba713cf59802c57d434466c5a1fe4069c37be1c934a5154bb3732e06bd3627ec7b09d5018715dc838a881981ae2afe9c2ce789a32e1ad86563e47bb01b3ab10d3cbb10c95884264336146de588f98aa83d7ac7e7f9308b4c4f3c783fa91c69757f0eaffe0d27d7a63b7ea38d2b56dae4dc2e768a5f02770c7f191d01d663e3eb0a81825fcf34c42b2e445d54191209f289d7458df4c5bf482e048bbfb093ee100370c01d9d31fc650dc7b42cac37ac9e2e368667025feebd294faa002f4acc81f6f09d5dce721ab8ed21a455a14d919b9b83e5f80ad79856f44fbd83c4edbcc4b7318b5ec1c4aff370161d7e851d49d8e52f36af2ed65bf0169ae7661ef5aab543dc6e5feecf9753181d2cc122c9185da7b2d8a5e741a5c1a9e025f933eca5618a556b216b7a0bcb60aa62559d34966479fce0c6e6e91736c61a6c268215db8dc8edc9d53a9a2af5d48bba96f879ca1218e87690e862b8a7421dbdf6c4b1a052096eaf61f16d287b50efc5156d04790f3ab3e433dfa0d47e2ed61cea6931153a8f8e04aa8215e46135ffad5df9632029a34a34ef8ce11476e6981e1441efb6fd0c57a4ec44b8d12ea64d98ff89351e21368e15844740d94aa224c0631aa5d263a04ba481892e16104a48cca231b08bbddffc5817de13aae24089f17ba4fce71b1a4059b397718b23d57e68e518e75a3a4a61d6304e7959d2c5e269bc8c28900f7ec23f8ff8ec378d8679acc0f774fc2c3faff1cfd988fa6282b10120273932595e0df5d816cd51197de427c937a52cc746f7b19503e3da293bee69af01eb5e754384c308f587be919ba9148ea9091eb7eefbe878d2b1a6c1f4693cbcf1e41ff1c7cb59dcd6ef3be07bcd511fc6540736a5a5bdc6efb550be67a40f2ae92161ef0564890141b4b08be866dd1ac5289589e611b3802d197446e095b1c8398e19cb3f130e5a3eb1a6789a3fefd082df199b04f85c2c59f93af596fdf556fd1e380b64c2b7040864554c3d34e05f055a4e42c58564972267ecd2d78754ec3331fdc829ddb09e31070ab54c37cd6373fe83cfa59c5e4806437a189296f22ded2d5f9c16bca99b8b320a47c5c119e39e533af9a34a162b5d80e99a0978191481b548b948f09783b07d34e8be9a2b22e5c70b03c90a767ba9f2cc7b2a20ca18a04ea4423b0e707f3503ca4b26be67bdaf4d5226614dd2aae702051a4f17e4c87846972045567ceae06abc7574276bd5b02a4a6290f0d61e891b6859d1b8e7e6e6f8d89c3820611095c909074e32bf08afe7fc18ee6c06f67d4d94abd88bbb87dd16e71f6473756a8665f710abb8b554c3e7a8a7f750744aadcbe5c7dd5b7769175e418d4dabd6a669ef8c8b02a7ca37099c524ebdce2c5c3023b56b6cddb2b82169d5ce4a9ec775150f53fa16c5ac95325cb0909b383606b408d2cf5ad930f5df20e2cb5dfa7d499f389ee74babed2694443597f4274096b9a7be52681792400bd493e6f536de7678681587cebb399d61170d81e240e38e78a7c686f02d33f7f606d9a83a68a4050f35cb82a31c41609fec04edf6af5c554085f563578d2f7f870f9bcd161055313c549f1eac760dca8adf941d70eb770fe151bdc02256665733d140d6a8fcbde09abde061fb8a80a5510890a331e59f81cc1313e7215bc552d6fb57fa8e141054d6ac289620f94349ddb3fc0c27416ca55f55658fa43189dae83f1cd4d8293dd5bc199c84a02f579e06b774cf967460f33167ec49e7a366835985e5ba56afa929231c247f4b4539904aceaa626d13034c41cd7e333ae7e76469b2e305171b591338da5ce444d78e5d7f58544f21763bd24ef7546be0a0102538e399cd6fe991dbfc525c7049ed53a4242a35224a43790099496c2a57d0","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
