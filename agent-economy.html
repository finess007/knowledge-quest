<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"5ca9c2d38d008f6af0a001422726e73acb90ac785fe14190bb109865300924688d45da2bad90d13c847263af47a04381043f1f95f68b21fe5521f9ba0c7d4c5fbf0bcd2e56c559910d1ad7e7c7b3755a68f4d2c294b90aaeba66132f66dbab4bd3cbe970e9fe66fde11a246613c6e998cef1fbaae484bfc86576d43df1530438755682bafd589da70fb2a7347faef179f4ea620a8252529777937704a242413bfe20a8810e5dc7d36cd90aee45a447616f01e1235789783c8a9a1e83d7bdb18243832b0405d3ce8365239ea0ef6d5d9eae466efcb8226de194c6cac7187fd42cf8bb98a0d1b9139ec0d6b59fd8e8ef4b64e10f253111e83259a2e2efa25605befdde6d9d91a07276796b7f39423ce91f81467b717bf717f94fa0f16a145a769ef97b2aa221feee95e4b084b5f41c3fbed320527687ef7b023a1a9abd37832414ee76cbf0e133ae424664c647ce5213a767b898fd37110ecc04f3beaaacae0036bbb4dd43726694cdb9a3498b5379a38ccc023f7fd1c66c362492eca902a02ece6d7056dc22b9cc63e274789d38812566e3267e9b13b13e9ad1ccf9b1371cca1c8d786518539acdbe691008085b96b91fe5477ea86cc9a6680067c9c69edf12533f9714aab32f5f010a56400f805f680c05a077000ee7b6cdc9b81b563b91610fad948be4a9b676719d70fe61a251efd090f16b1579b5857b310c8bc43a3940f95c08a848b1de2fe37fb1988f96c24343d773b61f316f6bd8b80f34318f3d6eb0fb017de0848fb76f0d3bd4735812400772aee1ac55c7b07dd5286f2a63b56e5ee4d7834772d9bb994ef50756620f840c9e1b22da2e178a059ec42df83acb80127234c7a2f9edd244e67b3cf4e338871dec2ec97b4236f4f3699bbbf4721ee76c80919b3d643ff3f08576d4f78776a45510178c190e06de56d52017be0bdfcc6bd0ee829973994e814f13dea3cdc8bca00040a0748897836c7a766b9314a6dc5950d009c499422b10cc779bbc37ce47501c5a2494096bbc8a6a142bdf1c980945fddf12764058e7321dc06f277cbd4f05194b422fa4abb9d3db384ebca20d9ea0f4f449fc6109d0e42f1bfd5890803529f2dfc66855568474a1cd4efb3d7675fcc0ead801d62db8e15e9c887c38bc682547894a0a89342433fc4ff573adba9830951d1453c8c93fdfa205cb186d4349c65e806b21a8cf6e6da8bf970eba4c1ef838ea8264ec33db3972b78b99ef44df78dd8b55ddff9a25ad84e11b8ae9b7a2884f281d2df1aa91d87a501f2f16fabb788965467744cc57b68f51b68db16db5faed6d8686f06a070a4b4f8296507f3ac843beadc2e26f39ee8cf3a7b7954f4f60a3b5242b9e40715936286fbb0e0a9fe4b50d896ec15077531c4a706ec3ffda1a3a524d8d57c993159b8e531877444af6f3bc9eb0867f9fae39ab5d0985c334caa2d995ef10954da2ade814692696777e2a654c27b32af350ab7176d855809786eeee47f8edcefa1851322d7f84833753651388e0b66971d6bfa905d0fec53cb95f2e7ee88c89f3d1b33b16f907ed227fc994eab591ececd2ddb9448dba9a183a1ace153af6adcfa5cc07443542dca23479009b5463272ba5e252445674bbc662958a3a3f27d21699cb5dcedee9c64a3fa9ce96a5b6256221b19e7f9f99005ff7657d552e16413518c6d8398c70948a8053ceb837e4719d215d5f71222779fc733707291c6bbbb72e3cd08747498c12ea46b06ba3e276229505cd1a94008bc0c3517898888716e953d201dac86babe754830e2c07ba26ac99eec284a02ae4e78be365a02d74dfed9e54a2fbfb30f80247ce3b5fa9769c0c5bdb442a6669ed3d85ff5f576a2abbb3c30e30ba7bbb17746922c4a21907a49a99c959f68bf72e1702fc4c93d7a1402bb1e1baaca9a7df0ce0e93e11dd81df9e61fd42b7c04b940a96b2f30c614d0da7d4f9136230f3d72d443b947dfb3ad53774d9d50376eb274fcb724da9b1c8696cecc95ae9419a30049fc42d23ba10159564f2a320a5a5b2dcf196d7fe21a3b16ee5080a883f787265548d11de0d93881271ab1b1497b7004850fd954869468cceb6c2677d5728bfce024f79f4cc0e33b33ba0dcba3799103fd59fe9eae19ca5c420761f44814058b6731a2013332275dcda6c74bfcc5ad833f95d02b3cc9fca801bf2c2045c24e841cfd4426f9ddca1386f6395f44a733a61a6b6b45a41f9051d1c29860469d44e88c5b311f4032db7b2b0f0bfc06f9efa8f04832efe3c17206dbd0f4179542be7bc9098bc8e3a18a46806bf4a805be454ff8562ca332e83dd623a6b41171fe5674a408d0c7033725742c1eb2d9b0e658acb9c68e43f01222d80b5251ee0f2ecb382191e597efde1a17d9b302a1b3c1eac558d50225093c2fa7f71340e0a31ae0818a9a60e3c0edcc4bb71dd9e0a31907bdac51b2678565ea643cf63f7d2cb238da876599e399e795d115526a0c8686f42a56192c0367b891cea163df71d48bcb2b76c43d4129543d9e05926684b673a040cdf4d8f2c9a3e5f881f3c5ca48276c84112d8ce2aa82865c48e61dd025b0a287f31bf4f5633bfd425cd2f191fe579eed098a67493de2e9667aeab0b94b119c15f8e225fd75c136b4dd353984cd6542373db977c7a3d37c0f47323721b42ebb4a751cc141debc0d0d41e17a4b02c3bef7b24b7bf4437c1c176bb30ad76cbfd36d0b06421903eb8cbcc42e2e5352a47a3ee9ad3ea941545a28aa660696e3a3d775fb0f463247bbd3400589ad7ce3958efe188a787af8457f5b9b805e0ccb4340f54ca56d08ccf615a5b8a83bf94ea0025ba08eed2acf28018af39d798ecd6737a8881daf9b2771909f9326e4142e0dcac05cfc68f2a8f8e3c884107483b61190466c02dee2090a946554cadd2fd20f48150b64e5099fdf1ac12945ff94aa057b4fc075b018b6cec7d77a25d69d71f1c1922acf520cf9a27160ce34698f61c0d9cf98a5e7a434928805497c9b5f639a7b6adfcc711cf998f5419d6674e36d5914e96a821eb47a97d34f69ff70ea9ba2de9b74ad4cdb1a6a01881d55d3c894330357259a01696ee90f115f2991b311348411539d95075a6d98c87a0c18f74f6f5c3fb8f5aefd821b82cf67ee9030567e89628ba069fbcc4b237b2fb9386cecb0f9944858d5335acbc167ad1155793b4243bb5e2ec4c38099c4b683c4d171b9d77ad9b8bd7dcb99b2c6943b81e76f2af1a8825fe427a4e78c0aaf52fc8d33632d99d6da7c26ef9742ed59dd0a9ee0c27695b2b778eb3a95a28c17fde9d22f9c9af37ea51a9a6a050712ade9bb9ca2fd1306fb153215c3015ab4c8c5684c591039e7be8972f7caf26250c705b07e768c382bb8397f7eee4a9e59fbc800f8bee96d730f895e84010d393d263c3d659ef2f3c8b5289e661572096963cbf4b25be58441e622c7e43b37aa40fc8731fdd12572e70d009293d8005fbb59b88583b251727a07b2b70af8b50e9659f2ceb44f28812c52e534f56803bf9ecd0549c751528290364dc8e70dac655ebbf9e724059262c8f06b1897883b0106b7f756cd94619efd93e415c5ed15f121474b9617f3138a93e938352102f70a279e5c1f463c8f3b8ed92d51dd9113e5a346795874b502ed2185a5e4ea20e657e0b3a29a69461042fe20e6417efc023bda8425ff9658164658178d5072b74a7fe7b70b94b101688f11cd7ad7af50fcd83eed270e940703c3ff600cbcdd012c0753fe07313f61914a228bef083abef55e48ddf7aa586ef1a4302d94f3d2c58c397cabb1d5f139e065d5dcc98f74d1bcf6ef2f733e91a012a6c662e9e99e067ea77fc2499c6add41cb93b93dfa1440360e6660a81be126a6153f78c0906bc78a609cf98671d600bd6c7b0ced5905217963b2e80e048153cbd8aa1c0b1561ef5bf4566e36d7612bce0a0930af4eb3a8bcedf520ac2a7d54b536c0b34e7c4ceaf04be3598abe9cc4d32e5476f98e494607b174507c53cadc5cc4a4849eece1e759bc896f50ca47ec25dcc8a4245b0abd2e2b0feaccb6c61a9f96bb8576808b0435b2159bbfdc84b7936260da28c7344fba6256f51852bd65e4c5689dd6c0d97446a50f768bebb04fd2d0cf706f56e9db7f4d121bd3466b2fbea963a7d9b8d162111c5810ef93279903c9a4b91da7a6ddad61e1a1836ddbb8ac6e40bc8b79c1fcc77b7a89685b1df1c53d60042edb008a780f8737e59f7bb760ec9600489a5d01901ec6a78e5cc28b756c8e4c6659fb2b57cc40ba8b05592a6b5e6c6cbe9adab47ae70c4a0d667fd5fddb7bbf60e2987aba43b9aee3c58f4ccf77472557c1a828f2971bf3c801ecc151fd1e368e9e4534546c9314c789bed64745ee3d1ed7447b191746bd73effc7775c83924fe552b1f0bf9c20a5e3000a13d9dc3fb96cae887648740be1d720b57b70db9a85ffeee8b935938e1074412f732a3349db51c17bc22f51f91a52d851add67bd71ad624d55ba380e05df5099396397f89eb6aa4b824bdf6414b2c985db2b4ef47f83c441a64d974979a941db9ee754c0323bbbf744e24f0aa96e881548e16e746832a901bc65a9a70a717fe0095b28be97bc2554c14b6ccf0fcf85ee88405f6430f76f59d1a7d7425fc94848f730121189bddc7d766e60004bfc377a0c8a965c7bdf1ad458577547c68c9e216cc82424b78ab854a9cd20dad13fb1b201ebf2cf7dcbf77f459854f00d84a8a578bc56efd67562349b9953b8a82f67b8ded726b4b854e2ab1e8f292f428affe04c17d6731b17be25e3bf7756f6edca05d1d3b15a04a35ac0f50bdeaa48f582a58423618c8b2cdf215691a35d8c566e08f53857d7e49d92f684475ad4c260bb35f848be2177e40ec4b8f616c4b6338bd68001fe81985e0ecd977d843c5fca576eb158d17ddd20a1ea9b8b320409b856c92d764c50368b916267f86765e605159633265c5fee47b65b5743b1e341ac6a28359acfcc67f0f91049fb0b9e235b65ab239794ab41d06a5fa84ddbd440f7e48b85a13f87cf451be962850f7575436c368cad37939fbb04174053e7b6ee637ccfccbb27e0a7e6ef985ec7aecea30fa888ebe853d5f3bed36e0d078fa9fa84cc978efada1b132f506da659d5bb8c8cc5135f0c4d5cae9aebf3dcf1b3df7e65f5d5e8f0809c7a3ef0737d1c01f5017b11ecf89996f8a1876c7655cd45eb386a95105dbc707d8e9682ffb0a382f6d46e72026dfb8b2de73e3332746c7496a19f5850750aeb55bef9def570f8c544f019bc75754fd92e1d2ecb5c008ae21286e6c89aea58cac0e434c57598ace63347ba27a411621810789c3776effebb8398417675772828557ef0c8daa2785d6c783464e1f61bbf40fc1003ddbf040f61ccf3ef6953c4a644255b12603e90e9f8a029ea8b01895eb05718c504a0006e7efa2d729950646e63613343372b3ed07c3ef2683f1c1e94bc4d0a262ad084a6352804612d1d582ddbe6242046282626263f95aad1584b30413e64561998366f9448790035f202f3dc39512c2cb73dda6b9a1c00c24c5a90a10bb192207d027639a6a9e6d83e6dc6bb2d7d10135c5f06ee736b487d04d076a8c22a75ae5f3c592dbafa81af4ddb0ef3b6c33dc0baf9c7d91452a9eab333b018ecde7e5a0115ab080fb434d526766ef014eb48a92711158d080f151cd1e2db3ea019cffef57d5aa5c64151dbc467234d5f964657a9617267db3690563f5aba98596ad251f23062d780bc420999cda7b5dc7a96a69e5060791b812f2a94366fbffcde1d76e919dfc9a6969d7f65a085574ca612947f3c2bfc5c93c149eb5ad5aae061f81806e257c211a9ca04a0d6eb4fb2a1507048406626e434fcccf7758927e1dad98579c61aa64b3b3c228a7cb99383feab3289848595e8add566d13b5beee8a3b9815d11d4ddf14a3db5d41e3cc19752e0589811172d4865d4c6b969e3dcd5bc989e4b512701ae9c09fa4f355c2a4ed1b3140f91627c3b093c0dd4a5ada6c964dbd2d891e08f6dc755da90217c200c22727cb93780943ef104c56d51d24767574ecfcbfb426304311fb49e7b5f988a39bc9726a603022edd49aa930ba5ea29df96cc2ba5a6d51c25e58a7d47c608a9021698662a763b047485148e4c306e526b751c368b4b931f824c927b2360da0f4e2602f617ff4a9a9c315741b10e962f43a6573dcffefb3436173c40a74ecb6309f47254197c03425ec5d223d7af6c96277ce0321b18dffb3b956a0c875a2eb3738af02b25f9cb4881af5338557494548ebd53ac594c75d8dbd01c1cdb2a13af1de8257324b3eb4b36c582d484fa6dd47fc7bdd234bbc19518ca0d46f4070321d258f54ad1ae6af61c4a242d1f36b094cf8deb7a4fbc7667557c600192ad0d6a0811360809bd7b1bfdb367f2570b7ba14950635bc6058958c341cd367bb2269e2f7c61b525767c5f456ec2b5dae60e0ffa67d79030c990bcb4482613f1e94bb68ac4a603754ffb8570be9058033a8a1bd4fa7e2c3ce45628c11790219f48dc2f171fc6a6076311515983c88e769748be75bddcb6c0f733f39098b3e32255bdf1d4509e4d4a81f26f06cfe717b152af620e7633f3502015f29864852e43d3f96c46b349262a6018a4580c31fa808b51aab3c2204b679d2a0a2e2bede0edabc31e0bbe66fa2b8df3f3c95731856e7243491430b9494dc8871e4ed844efadb031ed4990212c89b55b65945b8620986bdaa6d942aaf1a9c47af0bc6b033249f2849905b188ec2230e7243338a064b3d49b6f3315bd9c32f29f8e2265a74e26e64401fe3d4ccda59ece33546fea17599a363f44b74498fd5f7854f2be56dcc7155608bdd29c21cfa6073ea4406d993ef1c141976a0ed89cb58bff24703a85bb71ea693d136be24fc9b7321d55e90455e49066815391c1746584f0d3904f02cf1d78356247059c0fb40537fa4d904d834f4648361acee5066074ecc73647a77ca612b09a82f6806aedc56d975f9058f7784dd32be42282ca14d63d0621395b5b08846b399ec4983511ad92a0e72dcaefeb3bd0e847913bef727f5488e9d00e8cc913eae37bf452365857d5bc9cd8338a54b12d6d9326c517d2d34440f4d89c115e9a2a9774d3c1e886839122d76e79ddc41e4bac991dc5b4d6b930ce4ace0b6fca56d4fe7cb44c3ad3550589a67dd44ebb9b241de90b9294a76ad401fe1b781e510c483577a4cd64a25b4a1df02d3c837b5f76fbc3e3e801e11020d2e7373d8ec44557d3ffdbd447f4bec8dd9511241cff40ace140ca9f40a734d927bcc542c753271434a9287093874e918701683f816d0cfc026e6a15d2cf62b5bb2057e785c03157b171b67aaedc363d9ea61e6000f3a12856f564fcb5a6f673ab6c4508ed53e7d4e848219490004e24a2feea7dfafe06c4727170e70559b54d47a179336ed129c8108d9a4363ff976ee742e961515430c58a15a1917d99fe7afc86b00aa6ec0f05e7e46324c31b979bc3362a6269ec04b47c04235cfdd744e698d8d49940a8579f942ea8bf00279683d576e106f08d9fb10e3b7cde1ddde027baed9bd9807c9e72d915022f08cce416aab50fbd84eaf809cc2ebf88b1ab21f25572f6d3bc404977df5ea23fc66d50d572d3d856409f4e961421872a2b3467547c5d392f0db6d51b8a1031adf980c6b5b952d1ab01db269353b7c4d36d63e02c9fed17968017fc35529fb86d9feac7bc5a1473f904b28ee9c84cd578ae95ed2d1973b4c139a65ad8097d9e83dfbfc15eff48f6b0a4e36c6974b2c99fc1cc6e31fa64b6baac3146d2eb89884186adeb3a315d56dd7bd9cd15f66b6022a07697835addfea93da657bbcedf90e9c070dd045e0134a2bc2dfd2d7aa1fe566e30634af1e0032cd39daea425394447c11a759aa2a68687ebc419631e74b57de2b6a4a3b17a0d916bc3b71bdf9bc848f34aea06d4ab13034a0b3a8c3e199eb25c12adf17ffaadea72ea9e748172d75ca1a0eae28c6d5e618c677cc4128912456096c302ad243e437285c5b32e059f0bc662a967289b6c95530666cc14db36f02e0683752d92c3dbb721cac0af06e532962017891c8b8f68b6de826659b5bf3bb81a2d62c4ab1b19b12250fbf6cf0896746ad13d174fdf4e0de07346b66137aee79ef56318096f2d0f98506f5d94460aac68eedc1080a7040a5d2996e1e0c82dc792bafe841677814534be08548bc0d593a21993b3cc3e2a631858eaf815bed63efb99e3cc98a8201420050cac760d0bb63b815e44413174f4ea329cc1cb9abbc03e2d412741003ef7a513610c0a8ec6e9f4303b1503e2c5bcd70ff0b9c01c374b7cda82e607b28eec096bb8eb72621871102369c1c0104a3af6cd94fe252f485e8412dba5f3233009737d1d7bb37f2d15dc1051927006456b07b53c378fd50e988ef8d1d6a53018ae044f123249664983a10064f6cfc1951702c831263df240645e50b85c37bff13c4146d0a538846abe31b1cf6156b8301d62ccb37a5d2579afbd2e6be0f978faac92a50eb8d8f672bc534c5f7a969219eff3c16c1a9e150a63721a8d5e6615abedc9369fc8ace0bda5c8b99ef82292cf58ca9983eb11e222b69bce2dfa28b5bd06081a1ec7e3b3b70481bc108a930f0f9167f489a9db11318cfd5959f68f3ca8ff7ba4b7b9ec6b2603e505f7427fa52f7922b7c3bbfff5cacc0662c3ed1cb26492bc28b824928c444cdf8bb284fd3e2591330e5b4ef45e1ea7f948ac664442ea966a20139ea5758d562617bfac9eeabcb4b6bd037ba9b80ea398e0d450ae727c85ab4c261d3d6b65ddb28adb29689a26187a4921ea7bdd9b0fe51d7062cf4a355b09d17514bf37a49c4418fc8a2db2009755dcbbf9aa1d7453b580cc32357be31c60a4f49889255a024ba196995bf6789339e9b432b5bb725b4176c78b5d30af760db3e2ca9a3ac3bd9e1764d325e7a001042f78b394c2a4855a7168d78be63370702ea7dfb8e7a8e0b42816d838c44d8bf803c47807d23a246dd140ea645a004fba6ec61176064dee03bb3366a8cbfad712ad290f7a72a80f954570cba96ca593fc96d84bbdec12ecee71d83ccce73448e838894babd87fd14c80c4f8d8eca43ef7d1eae024882603daebe0b35d4f2d7a4bc7f5fc3634e86535dd18faa67f9ad527fc3ca6e34f73d82a1c7f767e32c2f377a3f46e3fe6017410c4bba13f824e7239b7629b96fa0d1c0d9a90c6b22f61f40ec6bb3759cb83cde035274d8483a52655e1b94eafce0bff3b707538ca97ab5f649d17015ef75fb78b322114f884e3f48c69c0d2f4f1b3d6e8b67c4b57ac7b718fb15ed7fbee8056ed78bf55b9e2abd46ec9d61e7430b0ef60ae7f61606294e6a5ac8496ec7be87b5c32a7d132e2bf376633fc958cd9888e18e7fd2ba64c5f23251b50d2996d509afec8242255b1583c64496774445d959e1bb0f005f6fdaba173cc62384bd73710bdff52843b4e95eaf548f4cb3d123a27195761459e2eafa5df09b6918508b51df8aace7f14152c3f15eb628d8035088e7313f509381706b5ba5ceec6ea27e78450301afd40be4a2137de8a2c3163f160c8d0140436b93455d3d33397b4a0b522886dd24be5f6871063b17ebf9eb5425206edafcbb3e2455d589d974cef0bdce2aff407827e152562bb1040f940d57f0fdb444b77e3b344c72a2055104c12769def2d48e0cc0bc3d37bd9929f29ea9737e39233a9dc91bc721adc679c880313254ef018c82895513e01877986b0a8f810877b92c179a1ad20ba52df71cac70bccf0ef6b243d6b767697cbe82f4c1ca41549e34d6a99dbf6950f43e6d24f412beb90e46c1e037599eeb9f9efd86ff9a25939fe2cde98b2115315c481d9140355e9779599f32222c0e39746e257ac4c9f1ae935fbd0fcb6fbea1d749cddc2aec822215483589be440f09aa3f92afaa01bcb256e5f9242815cf46f2bae6522f2920f55beb1cb8c0425b55294fe2f9bd94d18b72a4963af4088f36e13a92c0d2a54656742d3daacd92605e3aa2d8c66cd119ba6e0e813ef4be8e9c55ecf209b8349bb1fb0355b59a466d5a99cfa6e0e70912ca8bec0ee4ca12ea56ebed450b6198467831e15ef8497547fc9c51e1057b812b08ca41df5f7c5c959c6e3830b8525116f15e131225aaeec76b0e2361f17cdef17922ac3c4f326237b05be8fc1dd8f33d61b10ee21a40a4eb25d76d029e2aca2b799c477fe3a64187fe0d4caa46a32db6ec6138de7e00f0777899b2e835fb9ad816780b66b8ddcc1261a65568816ea2a06b66d6c2b9e4dc0ee5d296d94fe0816d11569d77833e1be901d032aab01f28b07b46aaee6dd48eb942ee390343192bd219b782f98abd3997ec5cf0e374d921590128381751a01458503868f61f9847010ab39499ed55af73df9c34f9ad158ffe9fdd29dd24425a2574de1e4e8810b5c4e293d290702e7ce6a798ac1a3ae85cc2d95f00536bf09ca807fc3997ce30b71ea0b3ba83ee4b175f41c232c809925541e2309fd9a47085672daea98273b27319698706a498eab5ae61557f85e0e3d8cd1dafad424904ace3ff5705e308c4a5b876a6e1936e39a6c3c696ddc4bdcd0100a6a4f9790a27d0fb8652a77a7544494d5af5e02c68aaa9bd6cf819813f2723782e8b6060584bd959c9f1a5c9220fa8b87216add1244ec0d3c59135ee6f6c8832fcd43d6715b7e52096f22c56f8d6388bdd58298b2d9d8136ee1edbd202b72f28e94fad7aec3eb84b121179379e7cd80b574b0efcb6763bbea539663e3e28f99e1052815a18646e7c8e552738433ddf634fd95bb77ae44a5e20005b42148774c83fd7b4163f15b93078e8cab89afa2283227b9ceddac2eea17464c070e7bbf71cbd9f6194a3e8527db6d972e578f852ace5791878db317b886ff188e698b15ba802713b4ea1899176e3fc7a7e83b9bb0f0412f40676e571f603585fae7ad2bb639114b36e3ee30b7a1cea77beea31c028aa14071bcd115b4326523f56ede828c4f75155362f5a8f7b0a8ed4d95f5d16458895ca576b7df4f42e1b785a7212db7f061644dad86dc6f33436a0a9ac37c1f0b8c1b2fd8b38377a475aa9b36a22719c6c62043cde4c53bf43a1386783fab992d8c2c735c4114c97364b4b5ce3501bd36303f10df5261d089777e278fe8b5989fbf193c662ca9ed18c754944e2d5393f21fd0edfd20e7a983110e34a749fcf5170a36af22f0dbc0ca0b03dc8c985897db160f1e4c23ae0e64a4ae0b7153f9a69a4fac5710f0219941cff6b03ff2ee2efa41012f646cc5d2de41b2eb8b843a8d7ec08fa442564a37523fb6d895b67d21c2bac17855d1a755556a0f232aefe8c981daba5530f1f8626860bb87f4886d3a19b43b607ee9decb6564f65236fa54505b0940f6a90dc0e1e997105f51ce89cef0f74a9b6f1040eb927144ae9956563aadb2784fb1227fac146f94267ddfd30923910f7ecd8ff8addd7764bdc53211ee932f2d4f986166c466ba58a9555925b0105e724db527a5bb9e30d79bfee6396b2160003ab671740fa63d11053dea6c2de828c491265592c73b521e6163a7e41d4e732deace9379ff205a1a9cb03e916620db40117872dd9abb5ed943e0cd4a42994a2c21796026f0d091131fc9ea19f84d1f9896bda3f63aee844d297f2f247a400d0c8e183df1e18fe205dbda4946996c01f85995924b352b63ade94fa9629492301f3a9acd288ef199f064fae0021478d413e7b0573e3ecae0dfd9bd77fab0675536b26ac00dbd6a4da41e2557b5274a765ac89f3694973003240321bb7f34c40d1dc9875ea8a13488026a22abcc6db93aaa1daaaf1ce8c6c14679158e34fa9b02875509231ea85c1b0022bf9b1a0b778e4efde7b355adf6912c82499fbb2ccdc051e8a84713f4ec613cd57465d765c3e66c8d5ebdb8250a8272fe48abf1de3896bc5c375dc4f937310e0930b277fca1493a5aaa0c792a3ee29852e44d9be65542bae9cf27b1f956c2158b163b75fc85aeaef572e44dc5fb8e362a2b3b2eef977528215bd50e2624bc7c7c4881d9be2f393d5517f26a4b53beee6e1d86082c42441378cbc420d6c30a494cfa6593727de6bfc401db64fb213974eb8b86f993c3aee31ad68fa17995f6eae1ac4cc22ea946e92fef4976b7851c6348fc05ba661819fdaaa19e0e2de8eeee1dec03ae6425844d1d199b8640df5ecc57ab46d6fdaa2cadedceb5866aafce8f2908a569760d9016867847b2610e701023c2bd440786f8cf98ec67809c999100d9683f237c00dc275ae995556670bc809d105fb7c3f0346d666637485cecf4fbd019871f2bf4c71f2ef574321eb19b1a5fc849e12193a61f5465184eb76782a7e99ed97d1deadd97db43cac547bcdd0476755ccf86eee7f452ff51d40f17985f5e0e6f4f4af153cc545498cdaafa992adfbbae81d94b4e0b6f8eccb41473202cbce2057a450f40dca68cce019db4ab13ebbc47f60f3c9b88d14f93ecbd38757787347bf1d89a79a499e530003765ddefd1c3eab937821c1fed23fbb564676d1ae3372d387590c43843aa6723a0302dda3a91ed9a131dcd9f4263a26bb7abb95c39dffef82cc66887a804946b90afca374dd8562fd6efff202fbee8faed0dafa6479bd853f0a87caa95324ad7851fd73feb2b60de768ef8e2fa227d6b41c50370cba1fb3a5fc67aa0599d3f5edcbe66f3c230009acf370ae568100171c939032767a72a57d6002176f84f92e931064c6d5d6bc3e8d54ac47830719564e209fd2171145444853c87baddecc88fd05e223f27e10cd02e4fed8c4f676787e3010cc53ba67910bda56b36d43e3ae2c68eecfbdf4eb58358028fcbae858456b8e772798ecea50befc452135bcc2cf5ebeedf4d10bc0dc816021549dec5b57b10faffce64252312a5e1e344841213ba8cc18a1f2bf903e9ff461ad3c30242386743a9e23c8e4ee19dd6913833677537eed2dceb2c8475b4fb016d4e556cbd980ef4de5338eb6f1a89e351b1b9d68a41095a48f2e4b13410cdf1659970d7c9af0bd5409bc2a9832c61ce7b0d0073cbbefe3ab0cb11c53a140e286482d9b6210e4e3a1ceb0c94d994e74637c6040e62b2a1a2cba12e7360526fd835655c0fa1f6a7861537b3ddb8e4429d06b0a9c5f893b11b9dcb85ce653bac698721f972a5adf75703a6101bf3bd00026c16eea24de52665dc199bc588b4d63c8c2b5b12d8893e94757dadeac6ba937054503a079bc8efa531c9fdfe94cf7af60c173ef1fc38aaf23769bfbd86190bea80a35503adaa2a8da210c9818696941304c2344a619799bbd22cca1fa49a699422da42263afcad545a015cab2dc35806692c19a8f13e7f0031ae206cfa8c58ad92e7e91a09e52320102418af9a99092fb52a0aabe321ef87e21c673e58ce9d0417bdbcebeb940036b1fe80897e25bbb847b0da193e636eebd0e93e89144f6f6be4a64a31876c7a2da3adc9a0edce2cc8bffa800b94dcee814c57da796bddbe2d0a457d0c19ebc93185a5ce69991691866b38a13bba90bf877cf5fc50b4ac5d700b4976f4cea50dfd9f4e2eae8953c8a902db4ae72a27011916f888a241a0b38eb9cd1498c1238761d84a4dd3dd6b9b79badd14192e5e6c83ec4cfe51dd2afd32f2ea44af200eb38337959d22f6107bb554d023d2703a38a7aca194cf1ef4935c6d1517b9f3c4bf69aaa476ef87d550c4316989f3304e06059a4feab1463274e0ac2c758cbacaf17dbbb6d23e316ff11658c25e9de1d0451f8cd2c9aae178a02d69c5864957cf2b0ea8d7a5066d6904a8fd5585c3436768fe91529084a47fffb92f7cf2854c1b7b8c9ddc14da8aa6266d4e65bec95fc55cb351bd4ddaad8a7e3876be7b3af0e8af9930e2e2be980221ca80c55b59d8fdc5ece8dde8dfbf9e7b8254dedaedb8030943c45a83aa3227b97127693eed281f1b4e5083aefde36dbd9f554149d6d38591f69667784f7987299d4bd97a1de2faf0248a67c6b6f4ec63a14043b5b167f1102a72c67431d608d6fbcd600bc7aa675b4ddbc7a1d026133e19994f535a165a1c9fc08f8bd466bc791994a828fca7315665e8ed8f04e81d54754ccb07cd92744aabfc8440608ad17633351200937ba62afc1c8a4874419ac60d48a1389a66d02db9bee117fbec67fef3cc485d4f6793b66d80f194ea664500131ba49772b100a2a977f3998f30e019a60f4d47461141225504bc2ff6a1f7509cb4a025f580d38f543b5f22a5ccd534438815813cc5b26cdbc30f3f95606b616a8fb512ed7ac20e092180fdbfb9dad662b6ff2e213ac97c82d76b25896f6a8867b578e8388a305ce65b770bd5d38ad9fdc92ae47c3f83d49e16d571e6735a4d56270a9b6aa32c2b35fa548c7b20c167cdf0f27b9884668aa7a831286d3eac6bedd230ca8536564ca46886279285ff50449faddfa8c4c345956d9ca4c544cbdb3a83554baac4b34e64bdb6a276a6665ab0ad20b92ff32b73de9fc84796f41786a5cb28ccf3749160c852c9137db53858763ccf17f3f6dccfc0135a3b45596615ff08251d51eeeeba21772709d7a04d3e457014a0d9495b636803323399ec0e2ba6364e438810066daef4f663d2f0710cb38452145f83553eb6d87a3f83c3175b49535c0ad4b77542335864d983bbc857e2f7693885ea80a147dccf863bfe7508189b11299a54f6660d9384f129312fc611a24f4e8ec00c37658e875bd9df81ec5782244a951059875dc8ebf9e8435d8d1dc8f1f5de439ad51944eff83dad7dffd429eeae384e404cb58e3988cebf62667def77f582439d81d6104c804e8be718172b231c13f6246ca91f19953078ad762fb308caceeab57182216fcedb4339593203c9959627bfbcdcd0e884510d294a44384e1cfdcdfc95c62b4d6b39d942735458dd99fcd94551cdc36dcd731d89a72b6ce04d776ea3fea2693af691053b28d1025dac2c828bcba69ff4a657bf5c62f2cbb78c2bcb64ccf67b14a51885adbb3c01ed2877ae423eecb07ed8062b2fdc7f98bdd32977cdc177892a3333795329757c22d30635cff426f087ca70b86806542f77163fb15f27e37e0c7f478dd16208076cddc1f8c8b6fd5cc05348033943989c219c23b41e9ebb2047f8e9d42451e210d16753fc89fa277add39d0b4e53fa1397fba7c5233ce48da9a7ce67802f91d47c8f038029ee85c3856d1fd34b52e196bce886cd4b0d46c8df1a71a8d42f396a1f7c62ff9aec9b6a3c1deb5ab566a8cfa0977d168c943558783ba00c2c40b213fcb987c487c60b0b80c5f345b729015401e19892171d15384cef548e314d79984e4773773fbe76e45d976ed5063cb2bfcad24960a649ae78368163c54a724b512ae8c79c1e3c7d747a4e490b77397820192399d723d31a1e88b67920bbdb5141df00e02c896f6552e12f0c362a317d3ffe2c754334c0d442c7af7db55f0c1ab329e23f74010b167e72129ca7d3d30514358cb6d0f4c97d511f8c2317f6f18dc80738020357213be8602d6c5c469c779e9b37b480cfbb181e09072cb124dea93f6f8a76e8dd8ae9c3a85c89e59fc2c6867d87070e7b95abad74786322aac5fd5f333ebed82ca3b134d3e68ccb7141891bde836e41c5ab46293085a734f9d3191af47dc50003c6ea13c71a623811fbe0ad4c635fa5dc3acdeb2d4fd86fedeac579295d7d94f853fd3d3bfc292fbb16897bd078aaf855ec7b4e6800a0cf9f4718ff115911d89d2b511e1a768bbaf00c07b102e41404da3c2c4365fe02fa0157f36daff712210de76ee2a4df1b9bfa3bf1ea8eba51c816da327560be5731a983f9304a79377a9878182a9fb9b1e9f7d68ce5d06dad3552626d7119b3c5b0de34a64429a9fd9e03c913ad536b975808653e9143fa2a26a737403e8282536177c99dc5b1ed7ecdc0a7ecfa8a0b535a280e25c5d010b612dfcc5e0af4b8cf398342519edfe84eeeb40f7dc1d1c12efa","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
