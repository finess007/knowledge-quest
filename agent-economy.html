<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"6e2901050f6f699e68394c7b0b3072a587e024d553dfbb97e5088296374e080316b7f9be992f590752d5d0c5d2767816a478725d5ceb09566e82ed5a8ef93425fe05749b023f12a4cf396a84e1b5ed5f15946775da20cd25b33bb9ff63332a0275b64e80e979d9e416c90f841de8d00517b8d6d56e3bdfa2ebd0e9551841f9f18fbfd75163c34b33257c27b8d99639d559b5aedf173102899ebbdbbdec471e8a7debf22b4be80bcd8a2c6645c5ce0ff776a5657e2be1ce98fb638beb0a080dbc1e41a7ea645e2585bb383f57a4f7ffab2ff3d90c1a29f07fcf3785b40603f662ea304504e83cea56c52f7cdf2a7e4d289585866bcf9a6f73fc455c1032f76c147726442e699b305725338d274b491761d2423361ff379001db61004fd1ac8f5a9b2a7085b968cb8e54e15d954c291921c20c19263aed51192fe9ab9ed2930beaba1154af5a0ec2d82e39c04a7007c1355c262089919643f48a8e6d0f00bbb945378c6144b2e38b1e8fb998216341f2188bb0f1e896d0e6ee7da19235e9771f4ec0d0c75e568a1326de287375e1f3b1e28f89eb98491ef76a09049ac4dca216937c8c8121a849a639b390e0fc18614d5030b5a651eaacbf69e669627d1f5d3ec1415a24be8424c3032aa98e8881210c6c907c07199652030e6d4aa62576fc4887c569552fcbf2e49511ee2f6d2256432a69a6ef24447fb70164cac1c4dca9172ef51e24f1d90cbbcd828eb938224e191fb2866320210d9231572c1c7e1e41bdcc072a63562b94b6e23a6a30aba2aabdc34359d187fe708640512f562e59f8e3acef0057c530cc8853987cf067886301a317f00b27ffb60012bf3d3de0ffa270bce8714af9c2a9f10fd6594c86990695780434ccc4d45f5129c1198c25c60d2087d9265c3b61978f2a535d8ca6c0af23829f2a14b4e859afeafd262c6219d4d7b0343dea1e1c0eafd285d1480adeffb84683a9b3307110fea2245677066f199079f4dee6aa2b328aa491171d24e867af3f32fa61a895803b2419fdfd89db0f03b594ccf4ee88739d4f8081a3a30c684ddabd1832f2dcfe24d9b3d1662b039216367cdb918c8c502d401b61944ba2e18ca9ae82e84f08cb492623eea1d468007f105ad4927d4423a63fa35a421f4613657d307cd037026971334a62a1a3865b85d4439829a31a4a20b8d86e5cf15116277076ac480a643cb95cf4a7dcd597b5e8bcafc820394bbe2f7c4178f81eb837f2107c27492f5ac8ee8b06d21ba2cd74f0bb7d938d1cdc2e146f4ca95d29c0854065987d2fc19d0d383313c8c05f73997d93ab7c64ec27a2d519a2a761cea1373e27f2418319175b3f66b4a140e46c76b66b0a3bf53c94fb311a925bbd0e8a357087f209f20484de9d5048425b484c556b1c8b79eb2ca78db385c3ead31abbbab77fef663146517459bd508935e620e8b9c79306974bd6e41b7603fe6a29cb0b9daed4051be99af5aca2794a7d3dc99767958a8e8c6c407ee445fd1fa7f19fe36e2dc41480a936f2b656f6c03707c96276cbfb401019de1601549900ed238e9e60bb9e3f7495f2a567aed15b29b486a6617795eb6a0774235efd41f4d4c8a41674ac67131cbc186859e2122e66d58d6462a8e2159ed0259062f8cfbde4d297987f902eced38a6c7f4fb11d65cdfa5a841c789ae90609b8dd9fc654176e1b81c0a02b3d5871ab2b5314f0a93b783e0e23f96a1d3903c040f387402f49315b3c60b5edd5c2d3a4dd32596a31c37eac25894b7c567e45a1a2ac7fddbe0a113d7099ad01d6031752e20441d7e64029a3b5402ecc2eff0bbcedf876a6ea5588386dfa94a8f137052c2bbd90bde6e9af683d008efa0ad59ad582ff3af25bf1a7211052a1a26ad1a48259eaac047378fc60a6c078a23c41fe1cc3cb5b9fff2c99bd97f82e2708a03237f10fb731482a66d8610faf9049e1658385462b755bb12c03a211f3941a297305b0163d9ac212e434561140ad85699a33645cb68842016389051cf6ed9f6c106f4f8c7edeb61543883958ae8c8357e225aacfd0cb4504c9e1e5853bc7aca79a6c29f59ee31166763c6f53bd6772ff26ac04634fa80b50f80e1b16848fda519890916c210b629213befd3ca612224023a5986bc800a484d7c78abea9c048a843e50955aa4a32f28560e2662cac5d7f5d81a892b6c305c61a103f48cd37a26870b5a8fb0f110aff2eb47839770adc8e2dff5d6a87efe7fde775a2b5b229e3f557a240733c1dcc5c49c2ce8abec0ba4a161602f763d0bf19c126a483f5cde0679f705d8f306138f92b04f537667e831e5a8914b8dec0d3b489e2fd5d0803b967b308b42f0341e975729710bd455643fa7620d58b592611a629094cf894747e397e7ff171e0d7a84ccb173a4df4eadb7705594d2b39d0e4aaaa0831e532a50ac3015ca943520b12928633e0a2e659bf01556891ba2dbd35935471045c2337eb5b7a1d1e3143e8dff20730701f6eccc482375f897229a2465f87425b1feab1501f5301cbf53a3c70ca628ec698eb02a34b9c562805a05f6060f6550a6fb4c6d36bd0dae181a12db2c89671a0cb7e286a598900329729beb5d26aea0d4c94d8c5a2e7d9bff0802288bdcf7e3e71dfebfcd067651be4fec73140a76ba484c636bc907ecd0675c538097e6bd0233e23f300dac87b1b9f9899be71b1cddd974f03cb40185f58ca41c957324f457790d596d052f6e6db047d33ef9db885270fec66808b270ae08d552106163f7ddbfe7b1dd1d1dc9131fc9fc0a75f38dda063ac6da1a68815ef8df3d7b8979eb283c00351ce53b90fd621138f825fce967e12f06d19f806a29e4e0ad21d1db24a650e2dd68a4ac285dd4287af694eb467f6a0e79da3b5162f58f26511f8275022475d100b5fefe9f2202e135780d12f9558e10d432b646ba41fb694b04f960385d80fe12760797eeffc3c306ae85bf6793534aade50dd143d00a6560bf519b5e53649e4b53daade7faad75b5747abff664105cff193b25281c9dc916803ff8653035b0645e3d1413d9e1990b629c7cc4ac6555b2f9e1b5c9c2f312bfa382495b29706c46856097a8082d6c200b96d996b47ca8d3681a7181b932aa66b715321918c6cb8a6262ab73558b7a649c937262604cf8b31549fadaad8e5a5f83f4329027cf716b49a2d6ebaf34eec10447aeada71615425a4d79dc2fcfc5743d1e06360c263f9e0f9778b7737d97e5a1a53c02a0c8cb0678a29996c8b4fc247db5e13675c7fdf6cdb8f8d75607ef46ed62d0d8b45fbebce40ef8d36ac3ba8f6f34e0a2ac048f43d1de4ad8bc79fcb8809fa9c15232959c04732ab579d653a368a3c0ade0c3324968510b753d6bf1771eaf43df6c9074381bd40cfc27cd4a1ad45b00a066f01988250fa6b7818a6c777bddd9c8fb96e9e0b18eb074b2b4b85e7801e6cb8300e5d8af54315ae5125ab6c83cc6613a3679500ca9b457059fb03b5f94ae2084e3b5138050bda810952871e5d865e615dc46e0877ce6bbaa9b2ea46cbaa49be4c826eec40e040c13b6010f976e079560fc4564b578ba4311e27b3f57f0b9b2c7068859e65de103e6a8d3a7f4c86056577a75cac19e824dba435615321c9d7a7aaf2fe4ed251429f28c02e5a894f49df3a756052695deffe9e036d0b5a6072d8ba12cf822ddc76ccc2b0d4ace1c87ebf9d514c785143dd651ac268d121ffd0972847076b6b3c1096c93075e8f0a1ceca0e4b81d40bf996d52f2a59259719b93f0ab3a6cbacdab6761be50fe500d8c3f7fe108387d134757cd489eee4cac33dff296bc654dd89d92dc92a5c6cee2902228c119f35500d63f609817917482353bad2da7930f9b392f514ee6fb39369c9bd6d581807cd28bb399378d1ee169ea8de5ce6361bf733b5658a5e103380988282132776d3c0b9b34bc6ae74c2a2d45ae09ffe4ab432f2aec6db70daf7d314026697f10494c38f7cec9cfe7ecd8e5b525b380a7953623962a09a621a3a53320f18ec741dc1d168a9185cad927fe57fbad13377fb9dc168192e92c469203afac56b80ff80abdd0d2e7f4f540b9d8fb0db6b527aca0524d76529e9b1a7a6288fc0e3859eb4ea4f7c9fd2b47537448cfae47e6a3a0e61315b0e8e09b38ffade3b66ed1e99acc822336a7065943c50e1cf6a8533a0e43abcbd4f5a941887957151c1f5c3ee67775d483d5a192574bdcb63e33a45f32a342739d5460b96a76e9546b7eb5c5309bd7675418e428b9b460aa36e0af568ea66f9bc4efb64560cd0984ced52f36aba95523e6c73f006e217a95a307265f41229de528b4763aada0491097f43f760b70fd62eacfab049b51a09f66f47e3e96808273e5202a5aaaedd467d2833117d9c8c6a1a9c70c756e86ad7a6971d785ace2f877a057be8c7f0cba6f36b981d3254e2cf854411ad9a028416d063c1cdf53492f1c4599fe05e786d9e7bdd35075159ed8394b9a177c49a832e8e8b4f9be0a64fbb84d99aa75018c9174a46009450b015967e7ca2c96b7f90d7aecbaa4c06fc3a2f5a8ad902c37f3be671d6bb04fe21e270293fd32f21d4eac1acf6540a20196910f58224493c0c4692372ffddf1039799fa8a9f73101c997d0aac686aa6e2283cfcc5af2cf213c14bc8d5885b3d83c43e848a572fd6277b07325db2d0d44e46d9a4bab034c3ab708d052fe65aa0cb1a4de8e886b2de7526f30524b7fcb03943a6864646c87cc93efcc473b45ad9a8cb399370bc3ab46fc0217eb13ab6d4ffa01e4b2f99e63a7b066944bef293af3db4b99adec675286bcba4885a0ea652007adb8a936df12287001a153e637d6ecaded8fb619057a248929e643a0fefceeb884e61cd4f345fa2b14f18aac14025ae56908e51e41179e09fb12926c3851924238f4433e6bc27577683e6f7abc4ce5bb1289def44d8c0b61b9a35979271088c04b864943c8f3461613bdcd5576b9f0af7dde0adb08940fd3b14157cd3ef833b9b5292cca0a641117b1f5de1cc9b72197337fc587f37246ac4a2459022a3d6e66acdb7320c4a63c16c9494719e12224479b051dc97f0dfaf46f70a5552496f65295d66359feeb7f51f2f1420c8cf7547f885fce306a0446d375ac0d6d2428e3b843d271d4961664db278c2ef3d1f9c594bfb21cac75c5a2309508081e8fdb28b445d325438cbd115ea277988d993c6d6f860247f9ea6ca9bec4216785cfb158d361efc905c727beb259f0acf27dc58e9b248ca1cdd6ce2a5630197fef1b8e2931ccef7bfd52a1d56e8cf261c6132a338ab4e9da18a3122b8f6e12ca7cc7ce391fdfe40e0d8061d6cb0e3f9b732f3dc47e9b5978e1fc9ee66f224f8260fd728e98e863240ae1cf6e2130944847835fe686cb5a5c1cdd72aa5a2484dad414f5905580778dda98531694ca4676272f53b4af5701786255f8b34f93b54b4c96199b6cbe8a97125ab9dd7b4841ec93bb196f51ed5f822c547fc8246831c1d9bb261d3f838f0da18073e4a253c89d81bbe21478b7fd4767e131eff553576c1bb81773b09fea9b6366c545ec8351ff3d189d56c3db419b0dbe1c03c6a2683bbde4d81070dceaa16725b9d66a34933dc879f5fd725edee654bfe8b98ae8a6f26a0d7b3be22657a42162a8df45a05bdc32d746840f1dac3b4694caedaf79669d57acb57405091b8b2ff93d7cee119eb9c6debafab8b1859d3f2dc046906fb2b5bcd8bc2bfa78839183c907602d5ab4e73e6009c5612ef4e8dd86e66b98050bff42160789bb9525edabab0ba781c53588a676e5bdcde58f5356650fc5b416fcae9424c9d1c2e25bb53ccb37ea1ad9e60af39e76352e27f46c86d5788b3e31c308d6dc3d6ec5a312daf3bb6b1e209723c6082c4f67828fca8d4bcb777b1401f917c4553549330ad8028a08774d83e912a83e02acf7160334a5d2b80167144c201cf74a983dcf176a210c42542ab5ce0241daf7e2c2d7584678cf3ec2d691754914b73e1b9bc56913c27293d9482558f9c68184c7f162aa729870a084694d2f16607bd9bdd75c255960066be5a2c52020b4e8f612a96c8d6cfa1b7173965b930cd2e975d7fa19aa5c9419ada93c3322befcf7abc64707a0027a0ec9c22a112ed79a65ddf9d7affd051f1b1d9163c42a999f510ae5123085468ca6fbb75a86077e8e9e8b27d04dd1d8fe81fd49ad545abf48af6122f2e90c1571edeac47c3fc2b91cd717cbf5597aab09937f57e36d3f10103a2a9ae3d305f25a6af4d33955479368663eacf1544838a1b2b3d1dee07d6bbfb793208a5a548527b3fa6224c28cae2d853ef1c9229302aa3ecf15566d193f7d21226d3590f691778a5be6e68a62f478b8e89a4ea91cb8c05c353c5e0137d35e6134e0c2d8cff6eaf0689d5e9d4d3d45554eb52304239304ba7a55ff2ad07f50fc81cd7a5a4d56885c0af5b1ad2ffa2e8ace568d9d6e44f32dab16727f8a21edb6c2dd50302f0370c6cb005712d86661de08313ce5463a336adec06a02874420a924e8858edafea2cf2db499b20f581a0e505d37edbaf794787594dd894fb9d212b97103e52a813bec7b9523cc09008daf2d340053c88d06c4b9b94f9b02600f769d2c86b56fc3660c3e93ada440506e3b83e72124e545a6492fa30704efff5db8f1b586bdbc1757c70c72b750044ee0cde9eeb8a046e806f78fec73a228ba4384942b1e9cafb9081f125ef392af8e76887ae402c86932f224f685a9cdf599a8f17863d775e95c49f0a310f4a52992f60c03b032863578fa53f0ba1ed4e066aed81c5890ae6b720c8c9f8b27710dbbc557b745fc332d79aff834f114be1579967010b8f7b4989e567c2b838e18188bcd570b8a595aa36a0c79b1de2da476c2b6af453c27d10f64829176e9e7b4d3d036af445eaf856ca3aed1651066a08405f93fcb2700093830c01b0582799ad090b3a19cb3239f065a5012a830822f4a8a785a29405ab6d497a640ce08b47041801357f4cd88fa9746e307b3445e64941ce1d4a2c6ae2e2722d1226e2d2e6c93a909d2c2e6b65aa4985a0920b546455c5a67a330f491cde81d29416b1cf5ffabf27db3e411a98aea32ad2c618c76751357c0c522b8e8bdcd64c6b2bee4c6a75f0d94bff32a90cd82016746bad62c77914840d16bfc0a3fbec60db4632c5f125aa06ddfbe72ab1fb53fae962498085be177116fbf353b5400fe92e070f4a6d47129ccff86930febf4827198352f8357a5a7a58274da2e64a8197e1ef13130e5d9bb936c158b02ce966916758a9aaf3195ac01547deacc459c0104078e32653d7ece0d1ba740130dfe3399fb04e7b5cf61575111ac3600989189368498e535e8bdb6389480ae941182291f9f5343cfda38de8fd95dbd5c3a37a5c239d8b33de85316aaa9eca3eef43e582a904e3c0b2cbed7c8eaad25e30952d3a6ae54e94883ab1ec44f098de9562ac477dd0702fdbc43b0d88c5f6d34edcba763ee8b68c664de0c9ff2add9d534ea7876005a8ae2bd6d01f3d93cb0d914292672507ccca18331d6ee3cfadb83b038b3d54868a0a50cfaea59afd0b37eb990a456533afb3410fa1f7ca006d9d7eb4358aaed3b9f6d41efd03e6f04933e508fd193b5183d9167b8fad514310b9403d0dfff997ff947e81a5ed8bff24dc9032d043d8372d6c12995d98a3ace90285b11e2e2c5d6e260343c494a461c2dde04604840937b7d613dba5036120c16661d5f287d6e64c6aa56a4ca164f52c78d49fa9351d6770d84ce4f3a1d2ad3be50c911fbfe6aaa7bbbb50ad7a3bdb4557173c94dc887fa289918e8d7c4e5d3764a9ec09899a9f691889af97a63c3ff4410811fd1708d83d7fc90a302c8631af34dfddb1ff053474524fa6f98b54da80cd0d95dd51bf0193791f7fcfe51ad1469bf7a1d0db3b1b744514f9fb5649fe5d0185a0dbdb9ecba328887e37c43c40d70f8ab8c32ecfc80d0105c1af966261df3d6799619b60be2df0df189d3e2f0822c69a2d623a6c6ae391bd366f98982620c2f509c88e7f7339bcdd9471af3a665acf78201011172d8546844eddb51498f54d7d813a4591f995604b5a82cc2eabbe19a35158f9046a06f2f93c8b268ea5b908c722a2d27bfa3ee20b35a00e0ed6f4aa59aad72a1ee5e871a4f05bc9005e6b4f4f496ba90235c9111a593b045d001bd4f2ccb759d6f3b48300e0e6f9cf9af16b46a8c24829454cd53b2b6f249cddf6bddec4ff7ecd5bb124165d09c47f22de37d156ebd14e9f3daf465f4f017e4da3f49236595ac53bdbc0d5fd80855953f01c5ef82c4c84605a5f2fab767a3aa65af223ebed7588e16309152eeb5677aa04bb1a21d6ef8cdd6e851b42bd0788aa56586e2056a2504bfa195f1bf952756c8612093c4533ed76bf630a8771b65671e96ea300517188baa8a88e9e1260319e14cccfb457a4540fde3530d9c5dc46a6977cb60922c912f576b9f9856bbe1f429df41468b5859051079e3264f7aea7db76dbee3b3255743a5b7f0d06e6faa3e211fe5b8dac994f16cd55f7d95891d156d80ce4a04393c8e8b2f5f283638d39a64f49aad92e146f839fc9632e508875dce7698a09f69f27641ca42b7cbd52b94806414ac82e9cf7a5f55453af33e8d651df5786c2aff583fb71ce9439b32e5ba0a27c5ddaade68a2fd42dcbddbf85a86631dab8c139c3a1eed245220144c90ffac94848e1765e730bbc53113caef89189b2e141b7f0f2d9067b4fbfd7db0df6a13e4b7d6de74e8b7474a1c20a9015dd5043d1b50a5fcd60a4cb97c5d2e182d8eff48af36da72c4203c8e7f76d4ee412db9c512ee1b3844d99810abed088648c44194b0393423c54d1df7fc5a94c352d7712c0f8cbeea843f3942efa684446b13f9b3064b822f095be530970ec25df5d9da89df1a9f1751716a4f05f143f55c575f604435011bddc0ad24d16407147a743e32dbd4c4153097c01dae64622e16cc33c2630cf6fc9c784c3be35af7027102ef39394360b1efed82fe9d0405c6a9cfa59da46a43c75cc38facc42fdd14dc4c078dd44b1c54d9d25505c2ed940d5d3dfba3aa415ca736f5f67b040b5308d5030708a473382441429e1dcb4ca947af03a25312420e056fe22380644034034c7ff9e92044ec141eff0526166c8f31eadb35edf415cc156b007fb8eddbcc49026d4456f60d4509e41c3e58612628011bcfaebfc1e853054dabd66bf7b9c4821025e71028dfa127defa6e487f1e90666d63684a8c00e57cfbc3484bced91b851e6167fd573bdce9d8301f7ca6b3d43dafd915c8a071643989fa5f5517db15f72d9ea9ceba9def18a75e5f624b5e27511532e4e369dacbbcf539d9c68de0eec0186e147129414b8f2dcaab42ae2f211a199a253e4034061fc307517a569ce927b2fecf2915cf81e4aecf61dc1f9b65a8dc9ea4e52e742c63ceaedb8cf4357c4348f936de6ac8c627bff135567babdc50ba4dfb57d3f9ce68e9dff84c19f8d1b53496e8669b810439452b6bb071b6ad171cd696da837caaa8f56ddcd7330dfb5f125716b25504cac4721cdfa5a3c0596e5e50f4b3342bbf88d07728afda0ca54df6bc9b8f19724ccf9453cbf77c6deb7b28a6170f1903464bf9c23f10a23f0cabd30b02a0490bbfb3bf576a186c35a9a7bf30f149dfbc79fe50cd75b24a91f3428a62395b16a62ad3c7c4193de7cebe871e57c4a457ca5a8b9d66507f995933ba39dbff3ba1e8419250c462c10d9b1218aff12fdf55fc0f8c5930be2c72eba892acfa18421180180b337b0ed6d1013c41a0643164c8feb70df393b3a20ad333ccab44dcb8e27c049f675516dbaf2107368c5ca55a3fcb7ae099287e500a5429f4b65e51e69518090fcbe744bb1ad3e2c60f161aa4e563eb7ab4c6d5b149b690de4a522b7585eac4e5303142c19f599139ceefba1733d4953f1d3d18067f944d49ee6ac3d598d69293d34d8c9c2c1f03ddc12ba5d64cffa69c06dd47a31ce69d858beea854a775d897e9357c4a1d740aa9753c094a4072b8a8970e3eaf78231f7750127b7ca12ab0d78d1dbba0f33b4d78fbefdb508f95f63a526a88cac428d9c3c2fb1a02c477fc2bea25f707bae9ee737199ced336710e64e159b01b99019a4317c5703e34b07c4ee2c4a787263ac5fc0f8af0e9de7976724218acfb97364a590662a15c9c0e7ac01238a812a5da0f1c3e97995ef46a749756fa860162e99e32ffc92b2fa657ab9e96e8ed2c8a4eee4738b9a4c3e415fa988b03435182827ee4769800d29da707f8f37dab52e5af4f124fb6f1ccf89df43e675f4de5ee4935a898dfb4861d65d3d0d7d0fcecc54da644a645b0b80b522ba7c5d4c8ae11e5586f7d6286e96cfa07672d2af5eb9fdaff2ec1f7f133de7290c9491213e66185aa979bb25fbf66aac336e110d9c718d6162739227f6698d14e929006978505b2ea7bd022f337776264da6b81c5ce06cc5cf9522e542676c6ad95c21fbaa192b20943816a12f8f9ad0a8281b3abbee1a7fe5c5912591d21c94ffc73bc841c1314da6a5e4804a9b325d97c496bb768a54c9481335b70998a8a51b38eb79393d837b3556752cd48656045c62799ea30583319822f41ec59b2ff7b10dec9343d42dd3bd8a810d6e44ec1c1cfdec77a5fcb59d7f2aa0165b6712e4664c1812d72e64b974c4b882322d911da7264c4ee3f162430caa8ca7356780748c8c2b3b643ec468b0e7b5091e874af10d0cdcaae21add98516b9339ca7f610ffa84c575d8ab5fa605ef2c3740089188013c65fdc1131ec2f761d04e8e7cbc90679b8282ab6f4f9adeb80adf44d58ade63e8033b0c1b8fc344f00a972c1a6d8950883655d15fd8c258045582142dc0e56b13a4c392c3de93f0a239bced34d424edd6ce0f160e1aa036e5c3abd83ad900550861d9b43aa91c972466a43543a711b330144a1b9c1210529bbc6c44cf37463da59a6c3e79927ceadedefa30ca781694af74c14dd7191adf1e3e6caf985b3daf959f711af7843995aa9d8c29d9b7ba24b7704ac963d28d7229cd62482165d86611b460cbf4f88a4976466fbd10c4a94a76e74d6053e722334408abd3914611b4f9d1c761058ff85730a8c2bd479bf3f1f4835316201a04abca119826e92f9f5dec5523e3b8d6e750477708211a6456444c1eaae3dba42c893d2346384b6154102bb567f69c378297b938ccc463027b9408ab7492666250e3913b38a22670e645c9bc75945260e8a2cc7a6309832c7bbfe6c9801ada49a6aa898c593abda097c645621f1a7af10edde5d5fb752d47472b257595452aa32fabfccc803abf9f07915d14b7e46e9593fb17e95817f5c664ab0a1e6e9db6f891cbd8d0dde18cedc6069887009b5e873e69062e3a4dd491932b1aae9933983fd1acb4c9fed20d434371dafa9b13bcf503c02940259e38fe4e028c88df01d14f9993f69edcb980efce82056b534e5520446a1578bddbe144bebf1275b2cfda9ddb1408095af5d0cf911a38292a11ab292967f6be3af6f4c93b8017d624cb10fa3d124a3c8132fe70f1b186f45eca1b9c403e7673bf0c060031046a66cad316250dd9cc73615cd1242488df6634639d533498f52f79c7797f648a39a7eeee5856dc5562943160c2394efc836a6070a94e0e2a83a0b865e13e6ac0de520df85cd0bc90c833359b3338ec977c839bbe6d3cbad00ba2130daf81f27639f572c1d91f32e5c566b6a21dcde25e5f3b133e92385ea633b1d57668b0b09a612eab5b536b512330fd2c789f01cce33419b33cc821a0b8ba6541855c8dea78d0f98c27e465567927a11a60b34d0840b97df65f2fa853cfc25cfd52487cb423ab4eae294ba17aea32ffaf7c05a794d6fe48c49d4453fb732f6095d5d0c4bd869fb1ee9a0049766305520e3806f1505fe035dfeae610895c823475a49f382cc123f3db7cadb09c68d6625f99fd893cfc27d30963bc0f6be8c5db4b8bd8ccf331abc423594074cbe9f2d41c187b2a5af520bb7d39670e9f17e8fcc407e2148c4ef8c2253523b13f2e09d6656d54cedd36faee0f3341d004586a3d9c320de2b7c54ea738430d84546fbc0ce870f907ef69f0396ff3c004ebc61e4e5e158071b0b2bee80d12778cf91b605d9c7cf1fd14e2e9447ec7d6b5d285fc8f37ae978d144c80c79edc57fc494454eabad785262997f5da8cba7d723bee8d5aac8789eea2f1def830709b5d08cd4fee2906309e37d74a801b80e4af5afa161ae46175433e1a6ca573d134dfa2dc22c5fd27dac5db645e4e4dbfa136c01025f38df4c9fd97031b3d306c569f6e6e483171cd3b0da46facf9b8defeebad3f2991490a4e1c4d3fd955889f1317d911e3eda607dedd6cee80ad7659e617d5985d7442d59cf40fa2d0c83b30165657648e7c584e1f3783bffa01b61fd6e3116ee9533bcc70b994bd05ad83f2ea223eeb5e8b664c570495bdb54372a45b5b5a75e8d88569807de9a6d9a5e28eb6690c3329b343539699e740a07b86a1b9b20054a0f69e51e33e1255bc566669ff63a80a67556077f51c8ef70a3b49c24d262ffedad5506ba779aaaed81fb3414c7b1640294cc7ad963d4e78dc9fc8983c5e59fc52c273c0811f494a53b8ee85158c4f35ba21f061ffeadca135d2cca4f24fe311518047a2a99a4c23eeb1af9887b0e74df37ef1650311e44914c6666cc06304b422f586b50f6865df8084091a624046760b686a26281dc4921c649516b78095e1d75b5bae27655f5d597b5fb8c60c93b101b5b0f4b278b59072c03a0574d1a5b951d2ee9259eaf506cad2c5ef3f008fd967c07b61a5e4089b7f2d5e627e9ab8c939a1bc19cac1db6c74fa26514bbe972f25ff5ceb1f9dbcc48280153a967c50a79050fd29a40be875532fd4b8dede55f901d5eff5467fbec7445b0fa72675bec14fdbd78bea5f6afbdd28d9468c6ad76d347f6e34b11aff884a1cc4ebd3a50e05d74a93465087116acd4cf9e7c79037d1fb038756ff9799fac79808b7dba6f675b8d8e0dd2c8f0642307df287785b128335b164d94b9080058a42ce8eb978f1a6398a9d2a126696f90147b3a6bf3804fcd772c3be04ebb28e4f15222aea4529d7b27b676aa447c213aabbc40e063c00b9786d76b39db1a72943a1405a3c5bfea230185ed32d63218990c9f68067484c9d61090931d16815ded8862eaaed404678031dcbd43b4138474db5d76743a9c2d60d93692b66bced00359c5def3467f103e05776ddc8b4bc4ebc2d5bfa7a2561c9ff44d94249f353393efd50f75e4cc62e1faa49714fdbb12cb21b25a31324185d71e586c8ceca6984257bfca8c85c1754ab58b58768391ef50c2ff986edc0d9d433780363d29409b1e2a19c957d13650aad4b252bfd01b12bc4cb0c5548fc542d8c1625394dd95701ccea046d845be21d255683e33773e8dbacd887d30a8b50e0bfef0b042ae99688c827ce40d290f863aca843732315f8f707b12f05a29edb6d976f9cb72169f50d3a100266cbca2ecb375ed26a30ae891d133fb65fcfbf6fb9b9e61be38ee4d0debaeae8f65a3b3c0676941cdae73d965b60aa6f56e61d6b7f169eaaf4df5071bb67acbdfd65bea4c802c682e009cf8a2f1aa4ce8039d040c0d415cffe3fd341c076dae2d0a71c70c8a397a658c8be58c10e5dd584fc5cb48807e2d923b13e9e0b269e65981b39cc0d0d1a10cdad7d4d143dbe31e134162d9b08aa18e171fe5f796a68cb693b87daa9e4366673bf01b49d90fcfea9a3d07a6571e5dc165c1c3c7007ffb2fc093d2e88cc83a2469c5446d64aeb820e7c679dc595edadf3af5c13274c13dddd083e7a0f37ffc99e99cc2d1d6874f496d65e3a5a643cfe0f50a48d06e773be0a6760411d40081b7bd8363531159ce86f8bb9d7f9f922879e7da69343edbfed06671f08c3c4064c8fc89021fb20547e652a49c9c49123a2c98383f27bdac960ce97be4ad383564cdfd674bc7833987c3740c4fd45a8e7ac7e63547a920508ec94dea26b87b0a04a825fd7620ce75d13709fddec6a4a46ae990b154cd9bc74837dcf472b67f053325f36b6fdfb9c87f8a35a006ab92cf552b4ae11e6aa356ec803eeca650337befa67bdb350de69e64984abd5d8e39dfbf9a143d372f65b6bf47809f75612665cc050d3737343d2624255dbf8123b6a46312c81f6a69b36b150fd9cef31d0b86f30cb46849f45ee733e34cb75a43995ae0d53226472207c758a41e0224c44abea4501dbcffeeaf1f7a7cc77d66711af1d9cd131f437768a8a270ca82f117faf936078f0facaa6bb8260bdcf14d59091296776bcce8f80b040166571458ceb2ee0a8267d7cefd16e18c7714b90c601a4407711d116acf0d35d2bd47ce5b2a594374ecd5744329c1a6b93d28e8372005851d5e26f39c52dd8f9ab9305186f0907507ff1ba377e6a684fd167f86d79213297ec71cf5afc076a9e77498140947b6b808247946e392fea51b7f971c124524d229b2fdc824ea766a025adccbf206c94617cc97cf955ef459f31ea788350b979dcb0a8709bd09d0a276b006bd903546576a9cb65336be7fd31c1a3f35db7b1387b1cc757143d4d7c7787e79c9b594e0f0ff894808266e19500728f7e1e6be9426de5038ebd2656b306389c633417b7fa6c1e419b9122696193f3d411e9d600a8a51264df5af78f8b5edfcf5f2f8746cf7a57ddd6c3b1dec0e7490a4eb63bff308afc4f2f6e9fb7a4ec5e577d016a4a5d83e3e64edab065edb224aeef97a509f85c6515ae7b71e59b9f0aef59c090fd63a4029ac392074f399da5d0366d7a0319403d8daa4385bd692fde3426601eb649ef361700f3d55166b29bc76aecd0e51387caa02115a12b794df30114b7230c9fd75b4145d7e2bd4071ae0458c5e7c323eb788eea3bb008d535ed4d56a24b4e2c270f30fb7bc23e649d7c74e37e9da5783e726b4f02af5b4f56fdf8b571a0b6d8ac555682d86ba7a1d076fe6348a7b3ee53482ca86c15c4426a399bc97ff6848ec33b1be99ebfa125edc023e34eaf61860c0c5de6080d31e116a137f62d29cf69d7afaced5621350d4dd501d144cb43e8203495f3cfc968504cdb67d75ebaf5b785682b192caaf7b78d68d272c78e0cd987ae5c44832260145b2d1f839173298597c2a0ca54413bee19a35764112581536c8022d0f237b6b449de289e02ff47961237d624ae9b35dad77bde340304913feb885b832066d0f39eb88f4846dfb3bac44060d2692414e9c5c060aaf61ecfd49878a18dca60791316cf62ed847721d6a20229d82875fad87555934e9d27fdd2670fccb1c2a2366d01dc16a9679bd0d142598ca9230b79be6928da59fe6596268b8f1b3c5f039b34113318b7555dc12086365624a891a26963fd2e2f148d04fb231c53868a9de8d637339918c9a82ffdc1d7f53846961e1dba05b235827b4c18bef0f756e2ecccfc04243a5ca3b76022a023a4d0409a72f23892ba5f1bb71f6313fa1b3b83b21e50ab1584a8680edacdc73533fccc1ecb6339e3a602be4492e570561823fbea1f467a8c5fe129e51d4c41472793ea741ab2d88a32503b45b87903b09edd294f73ad50854d55f51dae89067ebe5092ccd0a915418d0c4ef527558dd782bf5ea60155b3084ddb68e36e894ed29b4b39086a9a8d94ecd69fe5bd6c1a1b16c912eea5971905e4ae3997d02c2e9750a66b4c7d3844dfa6b56efe6b76e44469fbdbe9c883885c04a21f819d35314d05d186e9a04f5bb383030c4441a486d1c049ec9bc3a11010e870054cd48f6ade3c811e2d2cec1a1d319cd4dfd6f678b12c38d79f437aae237d01583f4c9e3ee30cadb8fc00846a08c62875eca722fc03765453af98fc0d1958489440ca44b5ab4f6d49afc2586121ea85cd251413ab09bd2cc6e10e5a7636d3e65645000a2381984cfadfc7b90e61f992ab3ebf5ef1b9769ad8ca1e486c2d60a6ff12df4cc5c5b97ec62eb67ccac98c0ea468aa0ff327285168198","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
